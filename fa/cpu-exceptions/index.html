<!doctype html><html lang=fa><head><meta charset=UTF-8><meta content=yes name=apple-mobile-web-app-capable><meta content="width=device-width,initial-scale=1" name=viewport><meta content="light dark" name=color-scheme><meta content="ุงุณุชุซูุงูุง ูพุฑุฏุงุฒูุฏู ุฏุฑ ูููุนุช ูุง ูุฎุชูู ุฏุงุฑุง ุฎุทุง ุฑุฎ ู ุฏูุฏ ุ ุจู ุนููุงู ูุซุงู ููฺฏุงู ุฏุณุชุฑุณ ุจู ุขุฏุฑุณ ุญุงูุธู ูุงูุนุชุจุฑ ุง ุชูุณู ุจุฑ ุตูุฑ. ุจุฑุง ูุงฺฉูุด ุจู ุขููุง ุ ุจุงโฆ" name=description><meta content="Philipp Oppermann" name=author><link href=https://os.phil-opp.com/fa/cpu-exceptions/ rel=canonical><link href=/css/edition-2/main.css rel=stylesheet><link title="RSS feed for os.phil-opp.com" href=https://os.phil-opp.com/rss.xml rel=alternate type=application/rss+xml><script>let theme = localStorage.getItem("theme");
        if (theme != null) {
            document.documentElement.setAttribute("data-theme", theme);
        }</script><script async src=/js/edition-2/main.js></script><title>ุงุณุชุซูุงูุง ูพุฑุฏุงุฒูุฏู | Writing an OS in Rust</title><body><div class="container content"><header class=masthead><div style=position:relative><h2 class=masthead-title><a href=https://os.phil-opp.com title=Home>Writing an OS in Rust</a></h2><p><small>PhilippยOppermann'sยblog</small><aside id=all-posts-link><a title="All Posts" href=https://os.phil-opp.com/fa>ยซ ููู ูพุณุชโูุง</a></aside></div></header><div class=theme-switch><div title="Switch between light and dark theme" class=light-switch onclick=toggle_lights()></div><div title="Clear the theme override and go back to the system theme" class=light-switch-reset onclick=clear_theme_override()></div></div><div><aside class=right-to-left id=toc-aside><h2>ููุฑุณุช ูุทุงูุจ</h2><ol><li><a href=#brrsy-jmly>ุจุฑุฑุณ ุงุฌูุงู</a> <ol><li><a href=#jdwl-twsyf-khnndh-wqfh>ุฌุฏูู ุชูุตู ฺฉููุฏู ูููู</a></ol><li><a href=#ykh-nw-idt>ฺฉ ููุน IDT</a><li><a href=#qrrdd-frkhwny-wqfh>ูุฑุงุฑุฏุงุฏ ูุฑุงุฎูุงู ูููู</a> <ol><li><a href=#thbt-hy-hfz-shdh-w-tgyyrshwndh-scratch>ุซุจุงุช ูุง ุญูุธ ุดุฏู ู ุชุบุฑุดููุฏู (Scratch)</a><li><a href=#hfz-khlyh-thbth>ุญูุธ ฺฉูู ุซุจุงุชโูุง</a><li><a href=#qb-pshth-wqfh-the-interrupt-stack-frame>ูุงุจ ูพุดุชู ูููู (The Interrupt Stack Frame)</a><li><a href=#psht-shnh>ูพุดุช ุตุญูู</a></ol><li><a href=#pydh-szy>ูพุงุฏู ุณุงุฒ</a> <ol><li><a href=#brgyry-idt>ุจุงุฑฺฏุฑ IDT</a><li><a href=#jry-an>ุงุฌุฑุง ุขู</a><li><a href=#fzwdn-ykh-tst>ุงูุฒูุฏู ฺฉ ุชุณุช</a></ol><li><a href=#khyly-jdwyy-bwd>ุฎู ุฌุงุฏู ุจูุฏุ</a><li><a href=#mrhlh-b-dy-chyst>ูุฑุญูู ุจุนุฏ ฺุณุชุ</a><li class=toc-comments-link><a href=#comments>ูุธุฑุงุช</a></ol></aside><main><div class=right-to-left><h1>ุงุณุชุซูุงูุง ูพุฑุฏุงุฒูุฏู</h1><time class=post-date datetime=2018-06-17> Jun 17, 2018 </time></div><div class="warning right-to-left"><p><b>ูุญุชูุง ุชุฑุฌูู ุดุฏู:</b> ุงู ฺฉ ุชุฑุฌูู ุงุฒ ุฌุงูุนู ฺฉุงุฑุจุฑุงู ุจุฑุง ูพุณุช <strong><a href=https://os.phil-opp.com/cpu-exceptions/>CPU Exceptions</a></strong> ุงุณุช. ููฺฉู ุงุณุช ูุงูุตุ ููุณูุฎ ุดุฏู ุง ุฏุงุฑุง ุฎุทุง ุจุงุดุฏ. ูุทูุง ูุฑ ฺฏููู ูุดฺฉู ุฑุง ุฏุฑ <a href=https://github.com/phil-opp/blog_os/issues/908>ุงู ุงุดู</a> ฺฏุฒุงุฑุด ุฏูุฏ!<p>ุชุฑุฌูู ุชูุณุท <a href=https://github.com/hamidrezakp>@hamidrezakp</a> ู <a href=https://github.com/MHBahrampour>@MHBahrampour</a>.</div><div class=right-to-left><p>ุงุณุชุซูุงูุง ูพุฑุฏุงุฒูุฏู ุฏุฑ ูููุนุช ูุง ูุฎุชูู ุฏุงุฑุง ุฎุทุง ุฑุฎ ู ุฏูุฏ ุ ุจู ุนููุงู ูุซุงู ููฺฏุงู ุฏุณุชุฑุณ ุจู ุขุฏุฑุณ ุญุงูุธู ูุงูุนุชุจุฑ ุง ุชูุณู ุจุฑ ุตูุฑ. ุจุฑุง ูุงฺฉูุด ุจู ุขููุง ุ ุจุงุฏ ฺฉ <em>ุฌุฏูู ุชูุตู ฺฉููุฏู ูููู</em> ุชูุธู ฺฉูู ฺฉู ุชูุงุจุน ฺฉูุชุฑู ฺฉููุฏู ุฑุง ูุฑุงูู ฺฉูุฏ. ุฏุฑ ุงูุชูุง ุงู ูพุณุช ุ ูุณุชู ูุง ูุงุฏุฑ ุจู ฺฏุฑูุชู <a href=https://wiki.osdev.org/Exceptions#Breakpoint>ุงุณุชุซูุงูุง breakpoint</a> ู ุงุฏุงูู ุงุฌุฑุง ุทุจุน ูพุณ ุงุฒ ุขู ุฎูุงูุฏ ุจูุฏ.</p><span id=continue-reading></span><p>ุงู ุจูุงฺฏ ุจุตูุฑุช ุขุฒุงุฏ ุฑู <a href=https://github.com/phil-opp/blog_os>ฺฏุชโูุงุจ</a> ุชูุณุนู ุฏุงุฏู ุดุฏู ุงุณุช. ุงฺฏุฑ ูุดฺฉู ุง ุณูุงู ุฏุงุฑุฏุ ูุทูุงู ุขูโุฌุง ฺฉ ุงุดู ุจุงุฒ ฺฉูุฏ. ููฺูู ูโุชูุงูุฏ <a href=https://os.phil-opp.com/fa/cpu-exceptions/#comments>ุฏุฑ ุฒุฑ</a> ุงู ูพุณุช ฺฉุงููุช ุจฺฏุฐุงุฑุฏ. ุณูุฑุณ ฺฉุฏ ฺฉุงูู ุงู ูพุณุช ุฑุง ูโุชูุงูุฏ ุฏุฑ ุจูุฑููฺ <a href=https://github.com/phil-opp/blog_os/tree/post-05><code>post-05</code></a> ูพุฏุง ฺฉูุฏ.<details id=toc-inline><summary><b>ููุฑุณุช ูุทุงูุจ</b></summary> <ul><li><a href=#brrsy-jmly>ุจุฑุฑุณ ุงุฌูุงู</a> <ul><li><a href=#jdwl-twsyf-khnndh-wqfh>ุฌุฏูู ุชูุตู ฺฉููุฏู ูููู</a></ul><li><a href=#ykh-nw-idt>ฺฉ ููุน IDT</a><li><a href=#qrrdd-frkhwny-wqfh>ูุฑุงุฑุฏุงุฏ ูุฑุงุฎูุงู ูููู</a> <ul><li><a href=#thbt-hy-hfz-shdh-w-tgyyrshwndh-scratch>ุซุจุงุช ูุง ุญูุธ ุดุฏู ู ุชุบุฑุดููุฏู (Scratch)</a><li><a href=#hfz-khlyh-thbth>ุญูุธ ฺฉูู ุซุจุงุชโูุง</a><li><a href=#qb-pshth-wqfh-the-interrupt-stack-frame>ูุงุจ ูพุดุชู ูููู (The Interrupt Stack Frame)</a><li><a href=#psht-shnh>ูพุดุช ุตุญูู</a></ul><li><a href=#pydh-szy>ูพุงุฏู ุณุงุฒ</a> <ul><li><a href=#brgyry-idt>ุจุงุฑฺฏุฑ IDT</a><li><a href=#jry-an>ุงุฌุฑุง ุขู</a><li><a href=#fzwdn-ykh-tst>ุงูุฒูุฏู ฺฉ ุชุณุช</a></ul><li><a href=#khyly-jdwyy-bwd>ุฎู ุฌุงุฏู ุจูุฏุ</a><li><a href=#mrhlh-b-dy-chyst>ูุฑุญูู ุจุนุฏ ฺุณุชุ</a><li class=toc-comments-link><a href=#comments>ูุธุฑุงุช</a></ul></details><h2 id=brrsy-jmly><a aria-label="Anchor link for: brrsy-jmly" class=zola-anchor href=#brrsy-jmly>๐</a>ุจุฑุฑุณ ุงุฌูุงู</h2><p>ฺฉ ุงุณุชุซูุง ูุดุงู ู ุฏูุฏ ฺฉู ูุดฺฉู ุฏุฑ ุฏุณุชูุฑุงูุนูู ูุนู ูุฌูุฏ ุฏุงุฑุฏ. ุจู ุนููุงู ูุซุงู ุ ุงฺฏุฑ ุฏุณุชูุฑุงูุนูู ูุนู ุจุฎูุงูุฏ ุชูุณู ุจุฑ 0 ฺฉูุฏ ุ ูพุฑุฏุงุฒูุฏู ฺฉ ุงุณุชุซูุง ุตุงุฏุฑ ู ฺฉูุฏ. ููุช ฺฉ ุงุณุชุซูุง ุงุชูุงู ู ุงูุชุฏ ุ ูพุฑุฏุงุฒูุฏู ฺฉุงุฑ ูุนู ุฎูุฏ ุฑุง ุฑูุง ฺฉุฑุฏู ู ุจุณุชู ุจู ููุน ุงุณุชุซูุง ุ ุจูุงูุงุตูู ฺฉ ุชุงุจุน ุฎุงุต ฺฉูุชุฑู ฺฉููุฏู ุงุณุชุซูุง ุฑุง ูุฑุงุฎูุงู ู ฺฉูุฏ.<p>ุฏุฑ x86 ุญุฏูุฏ 20 ููุน ูุฎุชูู ุงุณุชุซูุง ูพุฑุฏุงุฒูุฏู ูุฌูุฏ ุฏุงุฑุฏ. ูููุชุฑู ุขููุง ุฏุฑ ุฒุฑ ุขูุฏู ุงูุฏ:<ul><li><strong>ุฎุทุง ุตูุญู</strong>: ุฎุทุง ุตูุญู ุฏุฑ ุฏุณุชุฑุณ ุบุฑูุงููู ุจู ุญุงูุธู ุฑุฎ ู ุฏูุฏ. ุจู ุนููุงู ูุซุงู ุ ุงฺฏุฑ ุฏุณุชูุฑุงูุนูู ูุนู ุจุฎูุงูุฏ ุงุฒ ฺฉ ุตูุญู ูฺฏุงุดุช ูุดุฏู ุจุฎูุงูุฏ ุง ุจุฎูุงูุฏ ุฏุฑ ฺฉ ุตูุญู ููุท ุฎูุงูุฏู ุจููุณุฏ.<li><strong>ฺฉุฏ ูุงูุนุชุจุฑ</strong>: ุงู ุงุณุชุซูุง ููุช ุฑุฎ ู ุฏูุฏ ฺฉู ุฏุณุชูุฑุงูุนูู ูุนู ูุงูุนุชุจุฑ ุงุณุช ุ ุจู ุนููุงู ูุซุงู ููุช ู ุฎูุงูู ุงุฒ <a href=https://en.wikipedia.org/wiki/Streaming_SIMD_Extensions>ุฏุณุชูุฑุงูุนูู ูุง SSE</a> ุฌุฏุฏุชุฑ ุจุฑ ุฑู ฺฉ ูพุฑุฏุงุฒูุฏู ูุฏู ุงุณุชูุงุฏู ฺฉูู ฺฉู ุขููุง ุฑุง ูพุดุชุจุงู ูู ฺฉูุฏ.<li><strong>ุฎุทุง ูุญุงูุธุช ุนููู</strong>: ุงู ุงุณุชุซูุง ุฏุงุฑุง ุจุดุชุฑู ุฏุงููู ุนูู ุงุณุช. ุงู ููุฑุฏ ุฏุฑ ุงููุงุน ูุฎุชูู ููุถ ุฏุณุชุฑุณ ูุงููุฏ ุชูุงุด ุจุฑุง ุงุฌุฑุง ฺฉ ุฏุณุชูุฑุงูุนูู ููุชุงุฒ ุฏุฑ ฺฉุฏ ุณุทุญ ฺฉุงุฑุจุฑ ุง ููุดุชู ููุฏูุง ุฑุฒุฑู ุดุฏู ุฏุฑ ุซุจุงุช ูุง ูพฺฉุฑุจูุฏ ุฑุฎ ู ุฏูุฏ.<li><strong>ุฎุทุง ุฏูฺฏุงูู</strong>: ููฺฏุงู ฺฉู ฺฉ ุงุณุชุซูุง ุฑุฎ ู ุฏูุฏ ุ ูพุฑุฏุงุฒูุฏู ุณุน ู ฺฉูุฏ ุชุงุจุน ฺฉูุชุฑู ฺฉููุฏู ูุฑุจูุทู ุฑุง ุงุฌุฑุง ฺฉูุฏ. ุงฺฏุฑ ฺฉ ุงุณุชุซูุง ุฏฺฏุฑ ุฑุฎ ุฏูุฏ <em>ููฺฏุงู ูุฑุงุฎูุงู ุชุงุจุน ฺฉูุชุฑู ฺฉููุฏู ุงุณุชุซูุง</em> ุ ูพุฑุฏุงุฒูุฏู ฺฉ ุงุณุชุซูุง ุฎุทุง ุฏูฺฏุงูู ุงุฌุงุฏ ู ฺฉูุฏ. ุงู ุงุณุชุซูุง ููฺูู ุฒูุงู ุงุชูุงู ู ุงูุชุฏ ฺฉู ูฺ ุชุงุจุน ฺฉูุชุฑู ฺฉููุฏู ุง ุจุฑุง ฺฉ ุงุณุชุซูุง ุซุจุช ูุดุฏู ุจุงุดุฏ.<li><strong>ุฎุทุง ุณูโฺฏุงูู</strong>: ุงฺฏุฑ ุฏุฑ ุญุงู ฺฉู ูพุฑุฏุงุฒูุฏู ุณุน ู ฺฉูุฏ ุชุงุจุน ฺฉูุชุฑู ฺฉููุฏู ุฎุทุง ุฏูฺฏุงูู ุฑุง ูุฑุงุฎูุงู ฺฉูุฏ ุงุณุชุซูุง ุฑุฎ ุฏูุฏ ุ ุงู ฺฉ ุฎุทุง ุณูโฺฏุงูู ุงุณุช. ูุง ูู ุชูุงูู ฺฉ ุฎุทุง ุณู ฺฏุงูู ุฑุง ุจฺฏุฑู ุง ุขู ุฑุง ฺฉูุชุฑู ฺฉูู. ุจุดุชุฑ ูพุฑุฏุงุฒูุฏู ูุง ุฑุณุช ฺฉุฑุฏู ุฎูุฏ ู ุฑุงู ุงูุฏุงุฒ ูุฌุฏุฏ ุณุณุชู ุนุงูู ูุงฺฉูุด ูุดุงู ู ุฏููุฏ.</ul><p>ุจุฑุง ูุดุงูุฏู ูุณุช ฺฉุงูู ุงุณุชุซูุงโูุง ุ <a href=https://wiki.osdev.org/Exceptions>ูฺฉ OSDev</a> ุฑุง ุจุฑุฑุณ ฺฉูุฏ.<h3 id=jdwl-twsyf-khnndh-wqfh><a aria-label="Anchor link for: jdwl-twsyf-khnndh-wqfh" class=zola-anchor href=#jdwl-twsyf-khnndh-wqfh>๐</a>ุฌุฏูู ุชูุตู ฺฉููุฏู ูููู</h3><p>ุจุฑุง ฺฏุฑูุชู ู ุฑุณุฏฺฏ ุจู ุงุณุชุซูุงโูุง ุ ุจุงุฏ ุงุตุทูุงุญุงู <em>ุฌุฏูู ุชูุตูฺฏุฑ ูููู</em> (IDT) ุฑุง ุชูุธู ฺฉูู. ุฏุฑ ุงู ุฌุฏูู ู ุชูุงูู ุจุฑุง ูุฑ ุงุณุชุซูุง ูพุฑุฏุงุฒูุฏู ฺฉ ุนููฺฉุฑุฏ ุชุงุจุน ฺฉููุฏู ูุดุฎุต ฺฉูู. ุณุฎุช ุงูุฒุงุฑ ุจู ุทูุฑ ูุณุชูู ุงุฒ ุงู ุฌุฏูู ุงุณุชูุงุฏู ู ฺฉูุฏ ุ ุจูุงุจุฑุงู ุจุงุฏ ุงุฒ ฺฉ ูุงูุจ ุงุฒ ูพุด ุชุนุฑู ุดุฏู ูพุฑู ฺฉูู. ูุฑ ูุฑูุฏ ุฌุฏูู ุจุงุฏ ุณุงุฎุชุงุฑ 16 ุจุงุช ุฒุฑ ุฑุง ุฏุงุดุชู ุจุงุดุฏ:<table><thead><tr><th>Type<th>Name<th>Description<tbody><tr><td>u16<td>Function Pointer [0:15]<td>The lower bits of the pointer to the handler function.<tr><td>u16<td>GDT selector<td>Selector of a code segment in the <a href=https://en.wikipedia.org/wiki/Global_Descriptor_Table>global descriptor table</a>.<tr><td>u16<td>Options<td>(see below)<tr><td>u16<td>Function Pointer [16:31]<td>The middle bits of the pointer to the handler function.<tr><td>u32<td>Function Pointer [32:63]<td>The remaining bits of the pointer to the handler function.<tr><td>u32<td>Reserved<td></table><p>ูุณูุช ฺฏุฒูู ูุง (Options) ุฏุงุฑุง ูุงูุจ ุฒุฑ ุงุณุช:<table><thead><tr><th>Bits<th>Name<th>Description<tbody><tr><td>0-2<td>Interrupt Stack Table Index<td>0: Donโt switch stacks, 1-7: Switch to the n-th stack in the Interrupt Stack Table when this handler is called.<tr><td>3-7<td>Reserved<td><tr><td>8<td>0: Interrupt Gate, 1: Trap Gate<td>If this bit is 0, interrupts are disabled when this handler is called.<tr><td>9-11<td>must be one<td><tr><td>12<td>must be zero<td><tr><td>13โ14<td>Descriptor Privilege Level (DPL)<td>The minimal privilege level required for calling this handler.<tr><td>15<td>Present<td></table><p>ูุฑ ุงุณุชุซูุง ุฏุงุฑุง ฺฉ ุงูุฏุณ ุงุฒ ูพุด ุชุนุฑู ุดุฏู ุฏุฑ IDT ุงุณุช. ุจู ุนููุงู ูุซุงู ุงุณุชุซูุง ฺฉุฏ ูุงูุนุชุจุฑ ุฏุงุฑุง ุงูุฏุณ 6 ู ุงุณุชุซูุง ุฎุทุง ุตูุญู ุฏุงุฑุง ุงูุฏุณ 14 ุงุณุช. ุจูุงุจุฑุงู ุ ุณุฎุช ุงูุฒุงุฑ ู ุชูุงูุฏ ุจู ุทูุฑ ุฎูุฏฺฉุงุฑ ุนูุตุฑ ูุฑุจูุทู ุฑุง ุจุฑุง ูุฑ ุงุณุชุซูุง ุจุงุฑฺฏุฐุงุฑ ฺฉูุฏ. <a href=https://wiki.osdev.org/Exceptions>ุฌุฏูู ุงุณุชุซูุงูุง</a> ุฏุฑ ูฺฉ OSDev ุ ุงูุฏุณ ูุง IDT ฺฉูู ุงุณุชุซูุงูุง ุฑุง ุฏุฑ ุณุชูู โVector nr.โ ูุดุงู ุฏุงุฏู ุงุณุช.<p>ููฺฏุงู ฺฉู ฺฉ ุงุณุชุซูุง ุฑุฎ ู ุฏูุฏ ุ ูพุฑุฏุงุฒูุฏู ุชูุฑุจุงู ููุงุฑุฏ ุฒุฑ ุฑุง ุงูุฌุงู ู ุฏูุฏ:<ol><li>ุจุฑุฎ ุงุฒ ุซุจุงุชโูุง ุฑุง ุจู ูพุดุชู ูุงุฑุฏ ูโฺฉูุฏุ ุงุฒ ุฌููู ุงุดุงุฑู ฺฏุฑ ุฏุณุชูุฑุงูุนูู ู ุซุจุงุช <a href=https://en.wikipedia.org/wiki/FLAGS_register>RFLAGS</a>. (ุจุนุฏุงู ุฏุฑ ุงู ูพุณุช ุงุฒ ุงู ููุงุฏุฑ ุงุณุชูุงุฏู ุฎูุงูู ฺฉุฑุฏ.)<li>ุนูุตุฑ ูุฑุจูุท ุจู ุขู (ุงุณุชุซูุง) ุฑุง ุงุฒ ุฌุฏูู ุชูุตู ฺฉููุฏู ูููู (IDT) ูโุฎูุงูุฏ. ุจู ุนููุงู ูุซุงู ุ ูพุฑุฏุงุฒูุฏู ููฺฏุงู ุฑุฎ ุฏุงุฏู ุฎุทุง ุตูุญู ุ ุนูุตุฑ ฺูุงุฑุฏูู ุฑุง ู ุฎูุงูุฏ.<li>ูุฌูุฏ ุนูุตุฑ ุฑุง ุจุฑุฑุณ ูโฺฉูุฏ. ุงฺฏุฑ ุงูฺฏููู ูุจุงุดุฏ ฺฉ ุฎุทุง ุฏูฺฏุงูู ุงุฌุงุฏ ูโฺฉูุฏ.<li>ุงฺฏุฑ ุนูุตุฑ ฺฉ ฺฏุช ูููู ุงุณุช (ุจุช 40 ุชูุธู ูุดุฏู ุงุณุช) ูููู ูุง ุณุฎุช ุงูุฒุงุฑ ุฑุง ุบุฑูุนุงู ูโฺฉูุฏ.<li>ุงูุชุฎุงุจฺฏุฑ ูุดุฎุต ุดุฏู <a href=https://en.wikipedia.org/wiki/Global_Descriptor_Table>GDT</a> ุฑุง ุฏุฑ ุณฺฏููุช CS ุจุงุฑฺฏุฐุงุฑ ูโฺฉูุฏ.<li>ุจู ุชุงุจุน ฺฉูุชุฑู ฺฉููุฏู ูุดุฎุต ุดุฏู ูโุฑูุฏ.</ol><p>ุฏุฑ ุญุงู ุญุงุถุฑ ูฺฏุฑุงู ูุฑุงุญู 4 ู 5 ูุจุงุดุฏ ุ ูุง ุฏุฑ ููุฑุฏ ุฌุฏูู ุชูุตู ฺฉููุฏู ฺฏููุจุงู ู ูููู ูุง ุณุฎุช ุงูุฒุงุฑ ุฏุฑ ูพุณุช ูุง ุจุนุฏ ุฎูุงูู ุขููุฎุช.<h2 id=ykh-nw-idt><a aria-label="Anchor link for: ykh-nw-idt" class=zola-anchor href=#ykh-nw-idt>๐</a>ฺฉ ููุน IDT</h2><p>ุจู ุฌุง ุงุฌุงุฏ ููุน IDT ุฎูุฏ ุ ุงุฒ <a href=https://docs.rs/x86_64/0.14.2/x86_64/structures/idt/struct.InterruptDescriptorTable.html>ุณุงุฎุชูุงู <code>InterruptDescriptorTable</code></a> ฺฉุฑุช <code>x86_64</code> ุงุณุชูุงุฏู ุฎูุงูู ฺฉุฑุฏ ฺฉู ุจู ุงู ุดฺฉู ุงุณุช:<pre class=language-rust data-lang=rust style=background-color:#1e1e1e;color:#dcdcdc;><code class=language-rust data-lang=rust><span>#[repr(C)]
</span><span style=color:#569cd6;>pub struct </span><span>InterruptDescriptorTable {
</span><span>    </span><span style=color:#569cd6;>pub </span><span>divide_by_zero: Entry&LTHandlerFunc>,
</span><span>    </span><span style=color:#569cd6;>pub </span><span>debug: Entry&LTHandlerFunc>,
</span><span>    </span><span style=color:#569cd6;>pub </span><span>non_maskable_interrupt: Entry&LTHandlerFunc>,
</span><span>    </span><span style=color:#569cd6;>pub </span><span>breakpoint: Entry&LTHandlerFunc>,
</span><span>    </span><span style=color:#569cd6;>pub </span><span>overflow: Entry&LTHandlerFunc>,
</span><span>    </span><span style=color:#569cd6;>pub </span><span>bound_range_exceeded: Entry&LTHandlerFunc>,
</span><span>    </span><span style=color:#569cd6;>pub </span><span>invalid_opcode: Entry&LTHandlerFunc>,
</span><span>    </span><span style=color:#569cd6;>pub </span><span>device_not_available: Entry&LTHandlerFunc>,
</span><span>    </span><span style=color:#569cd6;>pub </span><span>double_fault: Entry&LTHandlerFuncWithErrCode>,
</span><span>    </span><span style=color:#569cd6;>pub </span><span>invalid_tss: Entry&LTHandlerFuncWithErrCode>,
</span><span>    </span><span style=color:#569cd6;>pub </span><span>segment_not_present: Entry&LTHandlerFuncWithErrCode>,
</span><span>    </span><span style=color:#569cd6;>pub </span><span>stack_segment_fault: Entry&LTHandlerFuncWithErrCode>,
</span><span>    </span><span style=color:#569cd6;>pub </span><span>general_protection_fault: Entry&LTHandlerFuncWithErrCode>,
</span><span>    </span><span style=color:#569cd6;>pub </span><span>page_fault: Entry&LTPageFaultHandlerFunc>,
</span><span>    </span><span style=color:#569cd6;>pub </span><span>x87_floating_point: Entry&LTHandlerFunc>,
</span><span>    </span><span style=color:#569cd6;>pub </span><span>alignment_check: Entry&LTHandlerFuncWithErrCode>,
</span><span>    </span><span style=color:#569cd6;>pub </span><span>machine_check: Entry&LTHandlerFunc>,
</span><span>    </span><span style=color:#569cd6;>pub </span><span>simd_floating_point: Entry&LTHandlerFunc>,
</span><span>    </span><span style=color:#569cd6;>pub </span><span>virtualization: Entry&LTHandlerFunc>,
</span><span>    </span><span style=color:#569cd6;>pub </span><span>security_exception: Entry&LTHandlerFuncWithErrCode>,
</span><span>    </span><span style=color:#608b4e;>// some fields omitted
</span><span>}
</span></code></pre><p>ููุฏูุง ุงุฒ ููุน <a href=https://docs.rs/x86_64/0.14.2/x86_64/structures/idt/struct.Entry.html><code>&LTidt::Entry&LTF</code></a> ูุณุชูุฏ ุ ุงู ุณุงุฎุชูุงู ุงุณุช ฺฉู ููุฏ ูุง ฺฉ ุนูุตุฑ IDT ุฑุง ูุดุงู ู ุฏูุฏ (ุจู ุฌุฏูู ุจุงูุง ูุฑุงุฌุนู ฺฉูุฏ). ูพุงุฑุงูุชุฑ ููุน <code>F</code>ุ ููุน ุชุงุจุน ฺฉูุชุฑู ฺฉููุฏู ููุฑุฏ ุงูุชุธุงุฑ ุฑุง ุชุนุฑู ู ฺฉูุฏ. ู ุจูู ฺฉู ุจุฑุฎ ุงุฒ ุนูุงุตุฑ ุจู ฺฉ <a href=https://docs.rs/x86_64/0.14.2/x86_64/structures/idt/type.HandlerFunc.html><code>HandlerFunc</code></a> ู ุจุฑุฎ ุฏฺฏุฑ ุจู <a href=https://docs.rs/x86_64/0.14.2/x86_64/structures/idt/type.HandlerFuncWithErrCode.html><code>HandlerFuncWithErrCode</code></a> ูุงุฒ ุฏุงุฑูุฏ. ุฎุทุง ุตูุญู ุญุช ููุน ุฎุงุต ุฎูุฏ ุฑุง ุฏุงุฑุฏ: <a href=https://docs.rs/x86_64/0.14.2/x86_64/structures/idt/type.PageFaultHandlerFunc.html><code>PageFaultHandlerFunc</code></a>.<p>ุจุงุฏ ุงุจุชุฏุง ุจู ููุน <code>HandlerFunc</code> ูฺฏุงู ฺฉูู:<pre class=language-rust data-lang=rust style=background-color:#1e1e1e;color:#dcdcdc;><code class=language-rust data-lang=rust><span style=color:#569cd6;>type </span><span style=color:#4ec9b0;>HandlerFunc </span><span>= </span><span style=color:#569cd6;>extern </span><span style=color:#d69d85;>"x86-interrupt" </span><span style=color:#569cd6;>fn</span><span>(</span><span style=color:#569cd6;>_</span><span>: InterruptStackFrame);
</span></code></pre><p>ุงู ฺฉ <a href=https://doc.rust-lang.org/book/ch19-04-advanced-types.html#creating-type-synonyms-with-type-aliases>ููุน ูุณุชุนุงุฑ(type alias)</a> ุจุฑุง ููุน โ<code>extern "x86-interrupt" fn</code> ุงุณุช. ฺฉููู ฺฉูุฏ <code>extern</code> ุชุงุจุน ุฑุง ุจุง ฺฉ <a href=https://doc.rust-lang.org/nomicon/ffi.html#foreign-calling-conventions>ูุฑุงุฑุฏุงุฏ ูุฑุงุฎูุงู ุฎุงุฑุฌ</a> ุชุนุฑู ู ฺฉูุฏ ู ุงุบูุจ ุจุฑุง ุจุฑูุฑุงุฑ ุงุฑุชุจุงุท ุจุง ฺฉุฏ C ุงุณุชูุงุฏู ู ุดูุฏ(<code>extern "C" fn</code>) . ุงูุง ูุฑุงุฑุฏุงุฏ ูุฑุงุฎูุงู <code>x86-interrupt</code> ฺุณุชุ<h2 id=qrrdd-frkhwny-wqfh><a aria-label="Anchor link for: qrrdd-frkhwny-wqfh" class=zola-anchor href=#qrrdd-frkhwny-wqfh>๐</a>ูุฑุงุฑุฏุงุฏ ูุฑุงุฎูุงู ูููู</h2><p>ุงุณุชุซูุงโูุง ฺฉุงููุงู ุดุจู ูุฑุงุฎูุงู ุชูุงุจุน ูุณุชูุฏ: ูพุฑุฏุงุฒูุฏู ุจู ุงููู ุฏุณุชูุฑุงูุนูู ุชุงุจุน ูุฑุงุฎูุงู ุดุฏู ู ุฑูุฏ ู ุขู ุฑุง ุงุฌุฑุง ู ฺฉูุฏ. ูพุณ ุงุฒ ุขู ูพุฑุฏุงุฒูุฏู ุจู ุขุฏุฑุณ ุจุงุฒฺฏุดุช ู ูพุฑุฏ ู ุงุฌุฑุง ุชุงุจุน ุงุตู ุฑุง ุงุฏุงูู ู ุฏูุฏ.<p>ุจุง ุงู ูุฌูุฏ ุ ุชูุงูุช ุนูุฏู ุง ุจู ูุฑุงุฎูุงู ุงุณุชุซูุงูุง ู ุชูุงุจุน ูุฌูุฏ ุฏุงุฑุฏ: ฺฉ ูุฑุงุฎูุงู ุชุงุจุน ุชูุณุท ฺฉ ฺฉุงููพุงูุฑ ฺฉู ุฏุณุชูุฑ โูุฑุงุฎูุงูโ ุฏุฑ ุขู ุฏุฑุฌ ุดุฏู ุงุณุช ุ ุงูุฌุงู ู ุดูุฏ ุ ุฏุฑ ุญุงู ฺฉู ฺฉ ุงุณุชุซูุง ููฺฉู ุงุณุช ุฏุฑ <em>ูุฑ</em> ุฏุณุชูุฑุงูุนูู ุฑุฎ ุฏูุฏ. ุจุฑุง ุฏุฑฺฉ ุนูุงูุจ ุงู ุชูุงูุช ุ ุจุงุฏ ูุฑุงุฎูุงู ุชูุงุจุน ุฑุง ุจุง ุฌุฒุฆุงุช ุจุดุชุฑ ุจุฑุฑุณ ฺฉูู.<p><a href=https://en.wikipedia.org/wiki/Calling_convention>ูุฑุงุฑุฏุงุฏ ูุฑุงุฎูุงู</a> ุฌุฒุฆุงุช ูุฑุงุฎูุงู ุชุงุจุน ุฑุง ูุดุฎุต ู ฺฉูุฏ. ุจู ุนููุงู ูุซุงู ุ ุขููุง ูุดุฎุต ูโฺฉููุฏ ฺฉู ูพุงุฑุงูุชุฑูุง ุชุงุจุน ฺฉุฌุง ูุฑุงุฑ ู ฺฏุฑูุฏ (ุจู ุนููุงู ูุซุงู ุฏุฑ ุซุจุงุชโูุง ุง ุจุฑ ุฑู ูพุดุชู) ู ูุญูู ุจุงุฒฺฏุดุช ูุชุงุฌ. ุฏุฑ x86_64 ูููฺฉุณ ุ ููุงูู ุฒุฑ ุจุฑุง ุชูุงุจุน C ุงุนูุงู ู ุดูุฏ (ูุดุฎุต ุดุฏู ุฏุฑ <a href=https://refspecs.linuxbase.org/elf/x86_64-abi-0.99.pdf>System V ABI</a>):<ul><li>ุดุด ุขุฑฺฏููุงู ุงูู ุจุง ููุน ุนุฏุฏ ุตุญุญ ุฏุฑ ุซุจุงุชโูุง<code>rdi</code>, <code>rsi</code>, <code>rdx</code>, <code>rcx</code>, <code>r8</code>, <code>r9</code> ููุชูู ู ุดููุฏ<li>ุขุฑฺฏููุงู ูุง ุงุถุงู ุจุฑ ุฑู ูพุดุชู ููุชูู ู ุดููุฏ<li>ูุชุงุฌ ุฏุฑูู<code>rax</code> ู <code>rdx</code> ุจุฑ ู ฺฏุฑุฏูุฏ</ul><p>ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุฑุงุณุช ุงุฒ C ABI ูพุฑู ูู ฺฉูุฏ (ุฏุฑ ูุงูุน ุ <a href=https://github.com/rust-lang/rfcs/issues/600>ูููุฒ ุญุช ฺฉ Rust ABI ูุฌูุฏ ูุฏุงุฑุฏ</a>) ุ ุจูุงุจุฑุงู ุงู ููุงูู ููุท ุจุฑุง ุชูุงุจุน ุงุนูุงู ุดุฏู ุจู ุนููุงู <code>extern "C" fn</code> ุงุนูุงู ู ุดูุฏ.<h3 id=thbt-hy-hfz-shdh-w-tgyyrshwndh-scratch><a aria-label="Anchor link for: thbt-hy-hfz-shdh-w-tgyyrshwndh-scratch" class=zola-anchor href=#thbt-hy-hfz-shdh-w-tgyyrshwndh-scratch>๐</a>ุซุจุงุช ูุง ุญูุธ ุดุฏู ู ุชุบุฑุดููุฏู (Scratch)</h3><p>ูุฑุงุฑุฏุงุฏ ูุฑุงุฎูุงูุ ุซุจุงุชโูุง ุฑุง ุจู ุฏู ุฏุณุชู ุซุจุงุช ูุง <em>ูุญููุธ ุดุฏู</em> ู <em>ุชุบุฑุดููุฏู</em> ุชูุณู ู ฺฉูุฏ.<p>ููุงุฏุฑ ุซุจุงุชโูุง <em>ูุญููุธ ุดุฏู</em>ุ ุฏุฑ ูุฑุงุฎูุงู ุชุงุจุน ุจุงุฏ ุจุฏูู ุชุบุฑ ุจุงู ุจูุงููุฏ. ุจูุงุจุฑุงู ฺฉ ุชุงุจุน ูุฑุงุฎูุงู ุดุฏู (<em>โcalleeโ</em>) ููุท ุฏุฑ ุตูุฑุช ูุฌุงุฒ ุงุณุช ุงู ุซุจุงุชโูุง ุฑุง ุชุบุฑ ุฏูุฏุ ฺฉู ููุงุฏุฑ ุงุตู ุขููุง ุฑุง ูุจู ุงุฒ ุจุงุฒฺฏุดุชุ ุจุฑฺฏุฑุฏุงูุฏ. ุจูุงุจุฑุงู ุจู ุงู ุซุจุงุชโูุง <em>โcallee-savedโ</em> ฺฏูุชู ู ุดูุฏ. ฺฉ ุงูฺฏู ุนููู ุงู ุงุณุช ฺฉู ุซุจุงุชโูุง ุฏุฑ ุขุบุงุฒ ุชุงุจุน ุจุฑ ุฑู ูพุดุชู ุฐุฎุฑู ุดุฏู ู ุฏุฑุณุช ูุจู ุงุฒ ุจุงุฒฺฏุดุช ุงุฒ ูพุดุชู ุจุฑุฏุงุดุชู ุดุฏู ู ููุฏุงุฑ ุฏู ุดููุฏ.<p>ุฏุฑ ููุงุจูุ ฺฉ ุชุงุจุน ูุฑุงุฎูุงู ุดุฏู ูุฌุงุฒ ุงุณุช ฺฉู ุจุฏูู ูุญุฏูุฏุช ุ ุซุจุงุชโูุง <em>ุชุบุฑุดููุฏู</em> ุฑุง ุฏูุจุงุฑู ุจููุณุฏ. ุงฺฏุฑ ูุฑุงุฎูุงููุฏู (<em>โcallerโ</em>) ุจุฎูุงูุฏ ููุฏุงุฑ ฺฉ ุซุจุงุช ุชุบุฑุดููุฏู ุฑุง ุฏุฑ ฺฉ ูุฑุงุฎูุงู ุชุงุจุน ุญูุธ ฺฉูุฏ ุ ูุงุฒู ุงุณุช ูุจู ุงุฒ ูุฑุงุฎูุงู ุชุงุจุน (ุจู ุนููุงู ูุซุงู ุจูุณูู ุงุถุงูู ู ุจุฑุฏุงุดุชู ุงุฒ ุฑู ูพุดุชู) ุขู ุฑุง ูพุดุชุจุงู ฺฏุฑ ู ุจุงุฒุงุจ ฺฉูุฏ. ุจูุงุจุฑุงู ุซุจุงุชโูุง ุชุบุฑุดููุฏู <em>caller-saved</em> ูุณุชูุฏ.<p>ุฏุฑ x86_64 ุ ูุฑุงุฑุฏุงุฏ ูุฑุงุฎูุงู C ุซุจุงุชโูุง ูุญููุธ ุดุฏู ู ุชุบุฑุดููุฏู ุฒุฑ ุฑุง ูุดุฎุต ู ฺฉูุฏ:<table><thead><tr><th>preserved registers<th>scratch registers<tbody><tr><td><code>rbp</code>, <code>rbx</code>, <code>rsp</code>, <code>r12</code>, <code>r13</code>, <code>r14</code>, <code>r15</code><td><code>rax</code>, <code>rcx</code>, <code>rdx</code>, <code>rsi</code>, <code>rdi</code>, <code>r8</code>, <code>r9</code>, <code>r10</code>, <code>r11</code><tr><td><em>callee-saved</em><td><em>caller-saved</em></table><p>ฺฉุงููพุงูุฑ ุงู ููุงูู ุฑุง ู ุฏุงูุฏ ุ ุจูุงุจุฑุงู ฺฉุฏ ุฑุง ูุชูุงุณุจ ุจุง ุขู ุชููุฏ ู ฺฉูุฏ. ุจู ุนููุงู ูุซุงู ุ ุจุดุชุฑ ุชูุงุจุน ุจุง <code>push rbp</code> ุดุฑูุน ู ุดููุฏ ฺฉู ูพุดุชุจุงู ฺฏุฑ ุงุฒ<code>rbp</code> ุฑู ูพุดุชู ุงุณุช (ุฒุฑุง ุงู ฺฉ ุซุจุงุช <em>caller-saved</em>).<h3 id=hfz-khlyh-thbth><a aria-label="Anchor link for: hfz-khlyh-thbth" class=zola-anchor href=#hfz-khlyh-thbth>๐</a>ุญูุธ ฺฉูู ุซุจุงุชโูุง</h3><p>ุจุฑุฎูุงู ูุฑุงุฎูุงู ุชุงุจุน ุ ุงุณุชุซูุงโูุง ู ุชูุงููุฏ ุฏุฑ <em>ูุฑ</em> ุฏุณุชูุฑุงูุนูู ุฑุฎ ุฏููุฏ. ุฏุฑ ุจุดุชุฑ ููุงุฑุฏ ุ ูุง ุญุช ุฏุฑ ุฒูุงู ฺฉุงููพุงู ูู ุฏุงูู ฺฉู ฺฉุฏ ุชููุฏ ุดุฏู ุงุณุชุซูุง ุงุฌุงุฏ ู ฺฉูุฏ ุง ูู. ุจู ุนููุงู ูุซุงู ุ ฺฉุงููพุงูุฑ ูู ุชูุงูุฏ ุจุฏุงูุฏ ฺฉู ุขุง ฺฉ ุฏุณุชูุฑุงูุนูู ุจุงุนุซ ุณุฑุฑุฒ ุดุฏู ูพุดุชู ุง ุฎุทุง ุตูุญู ู ุดูุฏ.<p>ุงุฒ ุขูุฌุง ฺฉู ูู ุฏุงูู ฺู ุฒูุงู ุงุณุชุซูุง ุฑุฎ ูโุฏูุฏ ุ ูู ุชูุงูู ูุจู ุงุฒ ุขู ุงุฒ ูฺ ุซุจุงุช ูพุดุชุจุงู ฺฏุฑ ฺฉูู. ุงู ุจุฏุงู ูุนูุงุณุช ฺฉู ูุง ูู ุชูุงูู ุงุฒ ูุฑุงุฑุฏุงุฏ ูุฑุงุฎูุงูโุง ุงุณุชูุงุฏู ฺฉูู ฺฉู ูุชฺฉ ุจู ุซุจุงุชโูุง caller-saved ุจุฑุง ฺฉูุชุฑู ฺฉููุฏู ูุง ุงุณุชุซูุง ูุณุช. ุฏุฑ ุนูุถ ุ ุจู ฺฉ ูุฑุงุฑุฏุงุฏ ูุฑุงุฎูุงู ูุงุฒ ุฏุงุฑู ฺฉู <em>ููู</em> ุซุจุงุชโูุง ุฑุง ุญูุธ ฺฉูุฏ. ูุฑุงุฑุฏุงุฏ ูุฑุงุฎูุงู <code>x86-interrupt</code> ฺูู ูุฑุงุฑุฏุงุฏ ูุฑุงุฎูุงู ุงุณุช ุ ุจูุงุจุฑุงู ุชุถูู ู ฺฉูุฏ ฺฉู ุชูุงู ููุงุฏุฑ ุซุจุงุชโูุง ุฏุฑ ููฺฏุงู ุจุงุฒฺฏุดุช ุชุงุจุน ุจู ููุงุฏุฑ ุงุตู ุฎูุฏ ุจุงุฒฺฏุฑุฏูุฏ.<p>ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุงู ุจุฏุงู ูุนูุง ูุณุช ฺฉู ููู ุซุจุงุชโูุง ุฏุฑ ูุฑูุฏ ุจู ุชุงุจุน ุฏุฑ ูพุดุชู ุฐุฎุฑู ู ุดููุฏ. ุฏุฑ ุนูุถ ุ ฺฉุงููพุงูุฑ ููุท ุงุฒ ุซุจุงุชโูุง ฺฉู ุชูุณุท ุชุงุจุน ุชุบุฑ ูโฺฉููุฏ ุ ูพุดุชุจุงู ุชูู ู ฺฉูุฏ. ุจู ุงู ุชุฑุชุจ ุ ฺฉุฏ ุจุณุงุฑ ฺฉุงุฑุขูุฏ ุจุฑุง ุชูุงุจุน ฺฉูุชุงู ฺฉู ููุท ุงุฒ ฺูุฏ ุซุจุงุช ุงุณุชูุงุฏู ู ฺฉููุฏ ุ ุชููุฏ ู ุดูุฏ.<h3 id=qb-pshth-wqfh-the-interrupt-stack-frame><a aria-label="Anchor link for: qb-pshth-wqfh-the-interrupt-stack-frame" class=zola-anchor href=#qb-pshth-wqfh-the-interrupt-stack-frame>๐</a>ูุงุจ ูพุดุชู ูููู (The Interrupt Stack Frame)</h3><p>ุฏุฑ ฺฉ ูุฑุงุฎูุงู ุนุงุฏ ุชุงุจุน (ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑุงูุนูู <code>call</code>) ุ ูพุฑุฏุงุฒูุฏู ูุจู ุงุฒ ูพุฑุด ุจู ุชุงุจุน ูุฏู ุ ุขุฏุฑุณ ุจุงุฒฺฏุดุช ุฑุง ุฏุฑ ูพุดุชู ุฐุฎุฑู ูโฺฉูุฏ. ุฏุฑ ููฺฏุงู ุจุงุฒฺฏุดุช ุชุงุจุน (ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑุงูุนูู <code>ret</code>) ุ ูพุฑุฏุงุฒูุฏู ุงู ุขุฏุฑุณ ุจุงุฒฺฏุดุช ุฑุง ุงุฒ ูพุดุชู ุจุฑูโุฏุงุฑุฏ ู ุจู ุขู ู ูพุฑุฏ. ุจูุงุจุฑุงู ูุงุจ ูพุดุชู ฺฉ ูุฑุงุฎูุงู ุนุงุฏ ุชุงุจุน ุจู ุงู ุดฺฉู ุงุณุช:<p><img alt="function stack frame" src=function-stack-frame.svg><p>ุจุง ุงู ูุฌูุฏุ ุจุฑุง ฺฉูุชุฑู ฺฉููุฏู ูุง ุงุณุชุซูุง ู ููููุ ุฐุฎุฑู ุขุฏุฑุณ ุจุฑฺฏุดุช ุฏุฑ ูพุดุชู ฺฉุงู ูุณุชุ ุฒุฑุง ฺฉูุชุฑู ฺฉููุฏู ูุง ูููู ุบุงูุจุงู ุฏุฑ context ุฏฺฏุฑ ุงุฌุฑุง ู ุดููุฏ (ูุดุงูฺฏุฑ ูพุดุชู ุ ูพุฑฺู ูุง ูพุฑุฏุงุฒูุฏู ู ุบุฑู). ุฏุฑ ุนูุถุ ูพุฑุฏุงุฒูุฏู ุฏุฑ ุตูุฑุช ูููู ูุฑุงุญู ุฒุฑ ุฑุง ุงูุฌุงู ู ุฏูุฏ:<ol><li><strong>ุชุฑุงุฒ ฺฉุฑุฏู ุงุดุงุฑูโฺฏุฑ ูพุดุชู</strong>: ุฏุฑ ูุฑ ุฏุณุชูุฑุงูุนูู ุงูฺฉุงู ุฑุฎ ุฏุงุฏู ูููู ูุฌูุฏ ุฏุงุฑุฏุ ุจูุงุจุฑุงู ุงุดุงุฑูโฺฏุฑ ูพุดุชู ูุฒ ู ุชูุงูุฏ ูุฑ ููุฏุงุฑ ุฏุงุดุชู ุจุงุดุฏ. ุจุง ุงู ุญุงู ุ ุจุฑุฎ ุงุฒ ุฏุณุชูุฑุงูุนูู ูุง ูพุฑุฏุงุฒูุฏู (ุจู ุนููุงู ูุซุงู ุจุฑุฎ ุงุฒ ุฏุณุชูุฑุงูุนูู ูุง SSE) ูุงุฒ ุฏุงุฑูุฏ ฺฉู ุงุดุงุฑูโฺฏุฑ ูพุดุชู ุฏุฑ ูุฑุฒ 16 ุจุงุช ุชุฑุงุฒ ุดูุฏ ุ ุจูุงุจุฑุงู ูพุฑุฏุงุฒูุฏู ุฏุฑุณุช ูพุณ ุงุฒ ูููู ฺูู ุชุฑุงุฒ ุฑุง ุงูุฌุงู ู ุฏูุฏ.<li><strong>ุชุนูุถ ูพุดุชูโูุง</strong> (ุฏุฑ ุจุนุถ ููุงุฑุฏ): ุชุนูุถ ูพุดุชู ุฒูุงู ุงุชูุงู ู ุงูุชุฏ ฺฉู ุณุทุญ ุงูุชุงุฒ ูพุฑุฏุงุฒูุฏู (CPU privilege level) ุชุบุฑ ู ฺฉูุฏุ ุจู ุนููุงู ูุซุงู ููุช ฺฉ ุงุณุชุซูุง ุฏุฑ ฺฉ ุจุฑูุงูู ุญุงูุช ฺฉุงุฑุจุฑ ุฑุฎ ู ุฏูุฏ. ููฺูู ู ุชูุงู ุชุนูุถ ูพุดุชู ุฑุง ุจุฑุง ูููู ูุง ุฎุงุต ุจุง ุงุณุชูุงุฏู ุงุฒ ุจู ุงุตุทูุงุญ <em>Interrupt Stack Table</em> ูพฺฉุฑุจูุฏ ฺฉุฑุฏ (ุฏุฑ ูพุณุช ุจุนุฏ ุชูุถุญ ุฏุงุฏู ุดุฏู).<li><strong>ูพูุด ฺฉุฑุฏู ุงุดุงุฑูโฺฏุฑ ูุฏู ูพุดุชู</strong>: ูพุฑุฏุงุฒูุฏู ููุงุฏุฑ ุงุดุงุฑูโฺฏุฑ ูพุดุชู (<code>rsp</code>) ู ุณฺฏููุช ูพุดุชู (<code>ss</code>) ุฑุง ุฏุฑ ุฒูุงู ูููุน ูููู (ูุจู ุงุฒ ุชุฑุงุฒ ฺฉุฑุฏู) ูพูุด ูโฺฉูุฏ. ุงู ุงูฺฉุงู ุฑุง ูุฑุงูู ู ฺฉูุฏ ุชุง ููฺฏุงู ุจุงุฒฺฏุดุช ุงุฒ ฺฉูุชุฑู ฺฉููุฏู ูููู ุ ุงุดุงุฑูโฺฏุฑ ุงุตู ูพุดุชู ุจุงุฒุงุจ ุดูุฏ.<li><strong>ูพูุด ฺฉุฑุฏู ู ุจูโุฑูุฒุฑุณุงู ุซุจุงุช <code>RFLAGS</code></strong>: ุซุจุงุช <a href=https://en.wikipedia.org/wiki/FLAGS_register><code>RFLAGS</code></a> ุดุงูู ุจุช ูุง ูุฎุชูู ฺฉูุชุฑู ู ูุถุนุช ุงุณุช. ุฏุฑ ููฺฏุงู ูููุน ูููู ุ ูพุฑุฏุงุฒูุฏู ุจุฑุฎ ุงุฒ ุจุชโูุง ุฑุง ุชุบุฑ ูโุฏูุฏ ู ููุฏุงุฑ ูุฏู ุฑุง ูพูุด ูโฺฉูุฏ.<li><strong>ูพูุด ฺฉุฑุฏู ุงุดุงุฑูโฺฏุฑ ุฏุณุชูุฑุงูุนูู</strong>: ูุจู ุงุฒ ูพุฑุด ุจู ุชุงุจุน ฺฉูุชุฑู ฺฉููุฏู ูููู ุ ูพุฑุฏุงุฒูุฏู ุงุดุงุฑูโฺฏุฑ ุฏุณุชูุฑุงูุนูู (<code>rip</code>) ู ุณฺฏููุช ฺฉุฏ (<code>cs</code>) ุฑุง ูพูุด ูโฺฉูุฏ. ุงู ูุดุงุจู ุจุง ูพูุด ฺฉุฑุฏู ุขุฏุฑุณ ุจุฑฺฏุดุช ฺฉ ุชุงุจุน ุนุงุฏ ุงุณุช.<li>** ูพูุด ฺฉุฑุฏู ฺฉุฏ ุฎุทุง** (ุจุฑุง ุจุฑุฎ ุงุณุชุซูุงูุง): ุจุฑุง ุจุฑุฎ ุงุฒ ุงุณุชุซูุง ูุง ุฎุงุต ูุงููุฏ ุฎุทุงูุง ุตูุญู ุ ูพุฑุฏุงุฒูุฏู ฺฉ ฺฉุฏ ุฎุทุง ุฑุง ูพูุด ูโฺฉูุฏ ฺฉู ุนูุช ุงุณุชุซูุง ุฑุง ุชูุตู ู ฺฉูุฏ.<li><strong>ูุฑุงุฎูุงู ฺฉูุชุฑู ฺฉููุฏู ูููู</strong>: ูพุฑุฏุงุฒูุฏู ุขุฏุฑุณ ู ุชูุตู ฺฉููุฏู ุณฺฏููุช ุชุงุจุน ฺฉูุชุฑู ฺฉููุฏู ูููู ุฑุง ุงุฒ ูุณูุช ูุฑุจูุทู ุฏุฑ IDT ู ุฎูุงูุฏ. ุณูพุณ ุจุง ุจุงุฑฺฏุฐุงุฑ ููุงุฏุฑ ุฏุฑ ุซุจุงุช ูุง <code>rip</code> ู <code>cs</code> ุงู ฺฉูุชุฑู ฺฉููุฏู ุฑุง ูุฑุงุฎูุงู ู ฺฉูุฏ.</ol><p>ุจูุงุจุฑุงู <em>interrupt stack frame</em> ุจู ุงู ุดฺฉู ุงุณุช:<p><img alt="interrupt stack frame" src=exception-stack-frame.svg><p>ุฏุฑ ฺฉุฑุช <code>x86_64</code> ุ ูุฑู ูพุดุชู ูููู ุชูุณุท ุณุงุฎุชูุงู <a href=https://docs.rs/x86_64/0.14.2/x86_64/structures/idt/struct.InterruptStackFrame.html><code>InterruptStackFrame</code></a> ูุดุงู ุฏุงุฏู ู ุดูุฏ. ุงู ุณุงุฎุชูุงู ุจู ุนููุงู <code>&mut</code> ุจู ฺฉูุชุฑู ฺฉููุฏู ูููู ููุชูู ู ุดูุฏ ู ู ุชูุงูุฏ ุจุฑุง ุฏุฑุงูุช ุงุทูุงุนุงุช ุจุดุชุฑ ุฏุฑ ููุฑุฏ ุนูุช ุงุณุชุซูุง ุงุณุชูุงุฏู ุดูุฏ. ุณุงุฎุชูุงู ุจุฏูู ููุฏ ฺฉุฏ ุฎุทุง ุงุณุช ุ ุฒุฑุง ููุท ุจุฑุฎ ุงุฒ ุงุณุชุซูุงูุง ฺฉุฏ ุฎุทุง ุฑุง ูพูุด ูโฺฉููุฏ. ุงู ุงุณุชุซูุงูุง ุงุฒ ููุน ุชุงุจุน ุฌุฏุงฺฏุงูู <a href=https://docs.rs/x86_64/0.14.2/x86_64/structures/idt/type.HandlerFuncWithErrCode.html><code>HandlerFuncWithErrCode</code></a> ุงุณุชูุงุฏู ูโฺฉููุฏ ุ ฺฉู ุฏุงุฑุง ฺฉ ุขุฑฺฏููุงู ุงุถุงู <code>error_code</code> ุงุณุช.<h3 id=psht-shnh><a aria-label="Anchor link for: psht-shnh" class=zola-anchor href=#psht-shnh>๐</a>ูพุดุช ุตุญูู</h3><p>ูุฑุงุฑุฏุงุฏ ูุฑุงุฎูุงู <code>x86-interrupt</code> ฺฉ ุงูุชุฒุงุน ูุฏุฑุชููุฏ ุงุณุช ฺฉู ุชูุฑุจุงู ุชูุงู ุฌุฒุฆุงุช ูพฺุฏู ูุฑุขูุฏ ูุฏุฑุช ุงุณุชุซูุงูุง ุฑุง ูพููุงู ู ฺฉูุฏ. ุจุง ุงู ุญุงู ุ ฺฏุงู ุงููุงุช ููุฏ ุงุณุช ฺฉู ุจุฏุงูู ูพุดุช ูพุฑุฏู ฺู ุงุชูุงู ู ุงูุชุฏ. ุฏุฑ ุงูุฌุง ฺฉ ูุฑูุฑ ฺฉูุชุงู ุงุฒ ููุงุฑุฏ ฺฉู ูุฑุงุฑุฏุงุฏ ูุฑุงุฎูุงู <code>x86-interrupt</code> ุงูุฌุงู ูโุฏูุฏ ุฑุง ูโุจูุฏ:<ul><li><strong>ุฏุฑุงูุช ุขุฑฺฏููุงู ูุง</strong>: ุจุดุชุฑ ูุฑุงุฑุฏุงุฏ ูุง ูุฑุงุฎูุงู ุงูุชุธุงุฑ ุฏุงุฑูุฏ ฺฉู ุขุฑฺฏููุงู ูุง ุฏุฑ ุซุจุงุชโูุง ููุชูู ุดููุฏ. ุงู ุจุฑุง ฺฉูุชุฑู ฺฉููุฏู ูุง ุงุณุชุซูุง ุงูฺฉุงู ูพุฐุฑ ูุณุช ุ ุฒุฑุง ูุง ูุจุงุฏ ูุจู ุงุฒ ุชูู ูุณุฎู ูพุดุชุจุงู ุงุฒ ููุงุฏุฑ ุซุจุงุชโูุง ุ ุขููุง ุฑุง ุจุงุฒููุณ ฺฉูู. ุฏุฑ ุนูุถุ ูุฑุงุฑุฏุงุฏ ูุฑุงุฎูุงู <code>x86-interrupt</code> ุขฺฏุงู ุงุณุช ฺฉู ุขุฑฺฏููุงู ูุง ุงุฒ ูุจู ุฏุฑ ูฺฉุงู ุฎุงุต ุจุฑ ุฑู ูพุดุชู ูุฑุงุฑ ุฏุงุฑูุฏ.<li><strong>ุจุงุฒฺฏุดุช ุจุง ุงุณุชูุงุฏู ุงุฒ <code>iretq</code></strong>: ุงุฒ ุขูุฌุง ฺฉู ูุงุจ ูพุดุชู ูููู ุจุง ูุงุจ ูพุดุชู ุตุฏุง ุฒุฏู ุชูุงุจุน ูุนููู ฺฉุงููุงู ูุชูุงูุช ุงุณุชุ ูู ุชูุงูู ุงุฒ ุทุฑู ุฏุณุชูุฑุงูุนูู<code> ret</code> ุงุฒ ุชูุงุจุน ฺฉูุชุฑู ฺฉููุฏู ุจุฑฺฏุฑุฏู. ุฏุฑ ุนูุถุ ุจุงุฏ ุงุฒ ุฏุณุชูุฑ <code>iretq</code> ุงุณุชูุงุฏู ุดูุฏ.<li><strong>ูุฏุฑุช ฺฉุฏ ุฎุทุง</strong>: ฺฉุฏ ุฎุทุง ฺฉู ุจุฑุง ุจุฑุฎ ุงุณุชุซูุงูุง ุจู ูพุดุชู ุงุถุงูู ู ุดูุฏ ุ ฺฉุงุฑูุง ุฑุง ุจุณุงุฑ ูพฺุฏู ุชุฑ ู ฺฉูุฏ. ุชุฑุงุฒ ุจูุฏ ูพุดุชู ุฑุง ุชุบุฑ ู ุฏูุฏ (ุจู ูุณูุช ุจุนุฏ ูุฑุงุฌุนู ฺฉูุฏ) ู ุจุงุฏ ูุจู ุงุฒ ุจุงุฒฺฏุดุชุ ุงุฒ ูพุดุชู ุฎุงุฑุฌ ุดูุฏ. ูุฑุงุฑุฏุงุฏ ูุฑุงุฎูุงู <code>x86-interrupt</code> ุชูุงู ูพฺุฏฺฏโูุง ุฑุง ุจุฑุทุฑู ู ฺฉูุฏ. ุจุง ุงู ุญุงูุ ูู ุฏุงูุฏ ฺฉุฏุงู ุชุงุจุน ฺฉูุชุฑู ฺฉููุฏู ุจุฑุง ฺฉุฏุงู ุงุณุชุซูุง ุงุณุชูุงุฏู ู ุดูุฏุ ุจูุงุจุฑุงู ุจุงุฏ ุงู ุงุทูุงุนุงุช ุฑุง ุงุฒ ุชุนุฏุงุฏ ุขุฑฺฏููุงู ูุง ุชุงุจุน ุงุณุชุฎุฑุงุฌ ฺฉูุฏ. ุงู ุจุฏุงู ูุนูุงุณุช ฺฉู ุจุฑูุงูู ููุณ ููฺูุงู ูุณุฆูู ุงุณุชูุงุฏู ุตุญุญ ูุฑ ููุน ุชุงุจุน ุจุฑุง ูุฑ ุงุณุชุซูุง ุงุณุช. ุฎูุดุจุฎุชุงูู ููุน <code>InterruptDescriptorTable</code> ฺฉู ุชูุณุท ฺฉุฑุช <code>x86_64</code> ุชุนุฑู ุดุฏู ุงุณุชุ ุงุณุชูุงุฏู ุงุฒ ุงููุงุน ุชุงุจุน ุตุญุญ ุฑุง ุชุถูู ู ฺฉูุฏ.<li><strong>ุชุฑุงุฒ ฺฉุฑุฏู ูพุดุชู</strong>: ุจุฑุฎ ุฏุณุชูุฑุงูุนููโูุง (ุจู ูฺู ุฏุณุชูุฑุงูุนูู ูุง SSE) ูุฌูุฏ ุฏุงุฑูุฏ ฺฉู ุจู ฺฉ ุชุฑุงุฒ ูพุดุชู 16 ุจุงุช ูุงุฒ ุฏุงุฑูุฏ. ูพุฑุฏุงุฒูุฏู ุงู ุชุฑุงุฒ ุฑุง ูุฑ ุฒูุงู ฺฉู ฺฉ ุงุณุชุซูุง ุงุชูุงู ู ุงูุชุฏ ุชุถูู ู ฺฉูุฏ ุ ุงูุง ุจุฑุง ุจุฑุฎ ุงุฒ ุงุณุชุซูุงูุง ุจุนุฏุงู ููฺฏุงู ฺฉู ฺฉ ฺฉุฏ ุฎุทุง ุฑุง ุจู ูพุดุชู ุงุถุงูู ูโฺฉูุฏุ ุฏูุจุงุฑู ุขู ุฑุง ุงุฒ ุจู ู ุจุฑุฏ. ูุฑุงุฑุฏุงุฏ ูุฑุงุฎูุงู <code>x86-interrupt</code> ุจุง ุชูุธู ูุฌุฏุฏ ูพุดุชู ุฏุฑ ุงู ุญุงูุช ุงู ูุดฺฉู ุฑุง ุจุฑุทุฑู ูโฺฉูุฏ.</ul><p>ุงฺฏุฑ ุจู ุฌุฒุฆุงุช ุจุดุชุฑ ุนูุงูู ููุฏุฏ: ูุง ููฺูู ฺฉ ุณุฑ ูพุณุช ุฏุงุฑู ฺฉู ูุฏุฑุช ุงุณุชุซูุง ุจุง ุงุณุชูุงุฏู ุงุฒ <a href=https://github.com/rust-lang/rfcs/blob/master/text/1201-naked-fns.md>ุชูุงุจุน ุจุฑููู</a> ุฑุง ุชูุถุญ ูโุฏููุฏ. (<a href=https://os.phil-opp.com/fa/cpu-exceptions/#khyly-jdwyy-bwd>ุฏุฑ ุงูุชูุง ุงู ูพุณุช</a>).<h2 id=pydh-szy><a aria-label="Anchor link for: pydh-szy" class=zola-anchor href=#pydh-szy>๐</a>ูพุงุฏู ุณุงุฒ</h2><p>ุงฺฉููู ฺฉู ุชุฆูุฑ ุฑุง ูููุฏู ุ ููุช ุขู ุฑุณุฏู ุงุณุช ฺฉู ุงุณุชุซูุงูุง ูพุฑุฏุงุฒูุฏู ุฑุง ุฏุฑ ูุณุชู ุฎูุฏ ฺฉูุชุฑู ฺฉูู. ูุง ุจุง ุงุฌุงุฏ ฺฉ ูุงฺูู ุฌุฏุฏ ููููโูุง ุฏุฑ <code>src/interrupts.rs</code> ุดุฑูุน ุฎูุงูู ฺฉุฑุฏุ ฺฉู ุงุจุชุฏุง ฺฉ ุชุงุจุน <code>init_idt</code> ุงุฌุงุฏ ู ฺฉูุฏ ฺฉู ฺฉ <code>InterruptDescriptorTable</code> ุฌุฏุฏ ุงุฌุงุฏ ู ฺฉูุฏ:<pre class=language-rust data-lang=rust style=background-color:#1e1e1e;color:#dcdcdc;><code class=language-rust data-lang=rust><span style=color:#608b4e;>// in src/lib.rs
</span><span>
</span><span style=color:#569cd6;>pub mod </span><span>interrupts;
</span><span>
</span><span style=color:#608b4e;>// in src/interrupts.rs
</span><span>
</span><span style=color:#569cd6;>use </span><span>x86_64::structures::idt::InterruptDescriptorTable;
</span><span>
</span><span style=color:#569cd6;>pub fn </span><span>init_idt() {
</span><span>    </span><span style=color:#569cd6;>let mut</span><span> idt = InterruptDescriptorTable::new();
</span><span>}
</span></code></pre><p>ุงฺฉููู ู ุชูุงูู ุชูุงุจุน ฺฉูุชุฑู ฺฉููุฏู ุฑุง ุงุถุงูู ฺฉูู. ุจุง ุงุถุงูู ฺฉุฑุฏู ฺฉ ฺฉูุชุฑู ฺฉููุฏู ุจุฑุง <a href=https://wiki.osdev.org/Exceptions#Breakpoint>ุงุณุชุซูุง ุจุฑฺฉโูพููุช</a> ุดุฑูุน ู ฺฉูู. ุงุณุชุซูุง ุจุฑฺฉโูพููุชุ ุงุณุชุซูุง ุนุงู ุจุฑุง ุขุฒูุงุด ูุฏุฑุช ุงุณุชุซูุง ุงุณุช. ุชููุง ูุฏู ุขู ูฺฉุซ ูููุช ุจุฑูุงูู ููฺฏุงู ุงุฌุฑุง ุฏุณุชูุฑุงูุนูู ุจุฑฺฉโูพููุช <code>int3</code> ุงุณุช.<p>ุงุณุชุซูุง ุจุฑฺฉโูพููุช ูุนูููุงู ุฏุฑ ุฏุจุงฺฏุฑูุง ุจู ฺฉุงุฑ ู ุฑูุฏ: ููุช ฺฉุงุฑุจุฑ ุจุฑฺฉโูพููุช ุฑุง ุชุนู ู ฺฉูุฏ ุ ุฏุจุงฺฏุฑ ุฏุณุชูุฑุงูุนูู ูุฑุจูุทู ุฑุง ุจุง ุฏุณุชูุฑุงูุนูู <code>int3</code> ุจุงุฒููุณ ู ฺฉูุฏ ุชุง ูพุฑุฏุงุฒูุฏู ููฺฏุงู ุฑุณุฏู ุจู ุขู ุฎุทุ ุงุณุชุซูุง ุจุฑฺฉโูพููุช ุฑุง ุงุฌุงุฏ ฺฉูุฏ. ููฺฏุงู ฺฉู ฺฉุงุฑุจุฑ ู ุฎูุงูุฏ ุจุฑูุงูู ุฑุง ุงุฏุงูู ุฏูุฏุ ุฏุจุงฺฏุฑ ุฏูุจุงุฑู ุฏุณุชูุฑุงูุนูู <code>int3</code> ุฑุง ุจุง ุฏุณุชูุฑุงูุนูู ุงุตู ุฌุงฺฏุฒู ู ฺฉูุฏ ู ุจุฑูุงูู ุฑุง ุงุฏุงูู ู ุฏูุฏ. ุจุฑุง ุฌุฒุฆุงุช ุจุดุชุฑ ุ ุณุฑ <a href=https://eli.thegreenplace.net/2011/01/27/how-debuggers-work-part-2-breakpoints>โ<em>ุฏุจุงฺฏุฑูุง ฺุทูุฑ ฺฉุงุฑ ูโฺฉููุฏ</em>โ</a> ุฑุง ุจุจูุฏ.<p>ุจุฑุง ููุงุฑุฏ ุงุณุชูุงุฏู ูุงุ ูุงุฒ ุจู ุจุงุฒููุณ ุฏุณุชูุฑุงูุนูู ูุฏุงุฑู. ุฏุฑ ุนูุถุ ููุท ูโุฎูุงูู ููฺฏุงู ุงุฌุฑุง ุฏุณุชูุฑุงูุนูู ุจุฑฺฉโูพููุช ูพุงู ฺุงูพ ฺฉูู ู ุณูพุณ ุจุฑูุงูู ุฑุง ุงุฏุงูู ุฏูู. ุจูุงุจุฑุงู ุจุงุฏ ฺฉ ุชุงุจุน ุณุงุฏู <code>breakpoint_handler</code> ุงุฌุงุฏ ฺฉูู ู ุขู ุฑุง ุจู IDT ุฎูุฏ ุงุถุงูู ฺฉูู:<pre class=language-rust data-lang=rust style=background-color:#1e1e1e;color:#dcdcdc;><code class=language-rust data-lang=rust><span style=color:#608b4e;>// in src/interrupts.rs
</span><span>
</span><span style=color:#569cd6;>use </span><span>x86_64::structures::idt::{InterruptDescriptorTable, InterruptStackFrame};
</span><span style=color:#569cd6;>use crate</span><span>::println;
</span><span>
</span><span style=color:#569cd6;>pub fn </span><span>init_idt() {
</span><span>    </span><span style=color:#569cd6;>let mut</span><span> idt = InterruptDescriptorTable::new();
</span><span>    idt.breakpoint.set_handler_fn(breakpoint_handler);
</span><span>}
</span><span>
</span><span style=color:#569cd6;>extern </span><span style=color:#d69d85;>"x86-interrupt" </span><span style=color:#569cd6;>fn </span><span>breakpoint_handler(
</span><span>    stack_frame: InterruptStackFrame)
</span><span>{
</span><span>    println!(</span><span style=color:#d69d85;>"EXCEPTION: BREAKPOINT</span><span style=color:#e3bbab;>\n</span><span style=color:#b4cea8;>{:#?}</span><span style=color:#d69d85;>"</span><span>, stack_frame);
</span><span>}
</span></code></pre><p>ฺฉูุชุฑู ฺฉููุฏู ูุง ููุท ฺฉ ูพุงู ุฑุง ุฎุงุฑุฌ ู ฺฉูุฏ ู ูุงุจ ูพุดุชู ูููู ุฑุง ุฒุจุง ฺุงูพ ู ฺฉูุฏ.<p>ููฺฏุงู ฺฉู ู ุฎูุงูู ุขู ุฑุง ฺฉุงููพุงู ฺฉูู ุ ุฎุทุง ุฒุฑ ุฑุฎ ู ุฏูุฏ:<pre style=background-color:#1e1e1e;color:#dcdcdc;><code><span>error[E0658]: x86-interrupt ABI is experimental and subject to change (see issue #40180)
</span><span>  --> src/main.rs:53:1
</span><span>   |
</span><span>53 | / extern "x86-interrupt" fn breakpoint_handler(stack_frame: InterruptStackFrame) {
</span><span>54 | |     println!("EXCEPTION: BREAKPOINT\n{:#?}", stack_frame);
</span><span>55 | | }
</span><span>   | |_^
</span><span>   |
</span><span>   = help: add #![feature(abi_x86_interrupt)] to the crate attributes to enable
</span></code></pre><p>ุงู ุฎุทุง ุจู ุงู ุฏูู ุฑุฎ ู ุฏูุฏ ฺฉู ูุฑุงุฑุฏุงุฏ ูุฑุงุฎูุงู <code>x86-interrupt</code> ูููุฒ ูุงูพุงุฏุงุฑ ุงุณุช. ุจู ูุฑ ุญุงู ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ุขู ุ ุจุงุฏ ุตุฑุญุงู ุขู ุฑุง ุจุง ุงุถุงูู ฺฉุฑุฏู <code>#![feature(abi_x86_interrupt)]</code> ุฏุฑ ุจุงูุง <code>lib.rs</code> ูุนุงู ฺฉูู.<h3 id=brgyry-idt><a aria-label="Anchor link for: brgyry-idt" class=zola-anchor href=#brgyry-idt>๐</a>ุจุงุฑฺฏุฑ IDT</h3><p>ุจุฑุง ุงูฺฉู ูพุฑุฏุงุฒูุฏู ุงุฒ ุฌุฏูู ุชูุตู ฺฉููุฏู ูููู ุฌุฏุฏ ูุง ุงุณุชูุงุฏู ฺฉูุฏ ุ ุจุงุฏ ุขู ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑุงูุนูู <a href=https://www.felixcloutier.com/x86/lgdt:lidt><code>lidt</code></a> ุจุงุฑฺฏุฑ ฺฉูู. ุณุงุฎุชูุงู <code>InterruptDescriptorTable</code> ุงุฒ ฺฉุฑุช <code> x86_64</code> ูุชุฏ <a href=https://docs.rs/x86_64/0.14.2/x86_64/structures/idt/struct.InterruptDescriptorTable.html#method.load><code>load</code></a> ุฑุง ุจุฑุง ุงู ฺฉุงุฑ ูุฑุงูู ู ฺฉูุฏ. ุจุงุฏ ุณุน ฺฉูู ุงุฒ ุขู ุงุณุชูุงุฏู ฺฉูู:<pre class=language-rust data-lang=rust style=background-color:#1e1e1e;color:#dcdcdc;><code class=language-rust data-lang=rust><span style=color:#608b4e;>// in src/interrupts.rs
</span><span>
</span><span style=color:#569cd6;>pub fn </span><span>init_idt() {
</span><span>    </span><span style=color:#569cd6;>let mut</span><span> idt = InterruptDescriptorTable::new();
</span><span>    idt.breakpoint.set_handler_fn(breakpoint_handler);
</span><span>    idt.load();
</span><span>}
</span></code></pre><p>ุงฺฉููู ููฺฏุงู ฺฉู ู ุฎูุงูู ุขู ุฑุง ฺฉุงููพุงู ฺฉูู ุ ุฎุทุง ุฒุฑ ุฑุฎ ู ุฏูุฏ:<pre style=background-color:#1e1e1e;color:#dcdcdc;><code><span>error: `idt` does not live long enough
</span><span>  --> src/interrupts/mod.rs:43:5
</span><span>   |
</span><span>43 |     idt.load();
</span><span>   |     ^^^ does not live long enough
</span><span>44 | }
</span><span>   | - borrowed value only lives until here
</span><span>   |
</span><span>   = note: borrowed value must be valid for the static lifetime...
</span></code></pre><p>ูพุณ ูุชุฏ <code>load</code> ุงูุชุธุงุฑ ุฏุฑุงูุช ฺฉ <code>static self'&</code> ุฑุง ุฏุงุฑุฏุ ุงู ูุฑุฌุน ุงุณุช ฺฉู ุจุฑุง ุชูุงู ูุฏุช ุฒูุงู ุงุฌุฑุง ุจุฑูุงูู ูุนุชุจุฑ ุงุณุช. ุฏูู ุงู ุงูุฑ ุงู ุงุณุช ฺฉู ูพุฑุฏุงุฒูุฏู ุฏุฑ ูุฑ ูููู ุจู ุงู ุฌุฏูู ุฏุณุชุฑุณ ูพุฏุง ู ฺฉูุฏ ุชุง ุฒูุงู ฺฉู IDT ุฏฺฏุฑ ุจุงุฑฺฏุฑ ฺฉูู. ุจูุงุจุฑุงู ุงุณุชูุงุฏู ุงุฒ ุทูู ุนูุฑ ฺฉูุชุงู ุชุฑ ุงุฒ <code>static'</code> ู ุชูุงูุฏ ููุฌุฑ ุจู ุจุงฺฏ ูุง ุงุณุชูุงุฏู-ุจุนุฏ-ุงุฒ-ุขุฒุงุฏุณุงุฒ ุดูุฏ.<p>ุฏุฑ ูุงูุน ุ ุงู ุฏููุงู ููุงู ฺุฒ ุงุณุช ฺฉู ุฏุฑ ุงูุฌุง ุงุชูุงู ู ุงูุชุฏ. <code>idt</code> ูุง ุฑู ูพุดุชู ุงุฌุงุฏ ู ุดูุฏ ุ ุจูุงุจุฑุงู ููุท ุฏุฑ ุฏุงุฎู ุชุงุจุน <code>init</code> ูุนุชุจุฑ ุงุณุช. ูพุณ ุงุฒ ุขู ุญุงูุธู ูพุดุชู ุจุฑุง ุชูุงุจุน ุฏฺฏุฑ ููุฑุฏ ุงุณุชูุงุฏู ูุฌุฏุฏ ูุฑุงุฑ ู ฺฏุฑุฏ ุ ุจูุงุจุฑุงู ูพุฑุฏุงุฒูุฏู ุญุงูุธู ูพุดุชู ุชุตุงุฏู ุฑุง ุจู ุนููุงู IDT ุชูุณุฑ ู ฺฉูุฏ. ุฎูุดุจุฎุชุงูู ุ ูุชุฏ <code>InterruptDescriptorTable::load</code> ุงู ูุงุฒ ุจู ุทูู ุนูุฑ ุฑุง ุฏุฑ ุชุนุฑู ุชุงุจุน ุฎูุฏ ุงุฌุจุงุฑ ู ฺฉูุฏุ ุจูุงุจุฑุงู ฺฉุงููพุงูุฑ ุฑุงุณุช ูุงุฏุฑ ุงุณุช ุงุฒ ุงู ูุดฺฉู ุงุญุชูุงู ุฏุฑ ุฒูุงู ฺฉุงููพุงู ุฌููฺฏุฑ ฺฉูุฏ.<p>ุจุฑุง ุฑูุน ุงู ูุดฺฉูุ ุจุงุฏ <code>idt</code> ุฑุง ุฏุฑ ูฺฉุงู ุฐุฎุฑู ฺฉูู ฺฉู ุทูู ุนูุฑ <code>static'</code> ุฏุงุดุชู ุจุงุดุฏ. ุจุฑุง ุฑุณุฏู ุจู ุงู ูุฏู ู ุชูุงูู IDT ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ <a href=https://doc.rust-lang.org/std/boxed/struct.Box.html><code>Box</code></a> ุจุฑ ุฑู ุญุงูุธู Heap ุงุฌุงุฏ ฺฉูู ู ุณูพุณ ุขู ุฑุง ุจู ฺฉ ูุฑุฌุน <code>static'</code> ุชุจุฏู ฺฉููุ ุงูุง ูุง ุฏุฑ ุญุงู ููุดุชู ูุณุชู ุณุณุชู ุนุงูู ูุณุชู ู ุจูุงุจุฑุงู ูููุฒ Heap ูุฏุงุฑู.<p>ุจู ุนููุงู ฺฉ ฺฏุฒูู ุฏฺฏุฑุ ู ุชูุงูู IDT ุฑุง ุจู ุตูุฑุช <code>static</code> ุฐุฎุฑู ฺฉูู:<pre class=language-rust data-lang=rust style=background-color:#1e1e1e;color:#dcdcdc;><code class=language-rust data-lang=rust><span style=color:#569cd6;>static </span><span style=color:#b4cea8;>IDT</span><span>: InterruptDescriptorTable = InterruptDescriptorTable::new();
</span><span>
</span><span style=color:#569cd6;>pub fn </span><span>init_idt() {
</span><span>    </span><span style=color:#b4cea8;>IDT</span><span>.breakpoint.set_handler_fn(breakpoint_handler);
</span><span>    </span><span style=color:#b4cea8;>IDT</span><span>.load();
</span><span>}
</span></code></pre><p>ุจุง ุงู ูุฌูุฏุ ฺฉ ูุดฺฉู ูุฌูุฏ ุฏุงุฑุฏ: ุงุณุชุงุชฺฉโูุง ุชุบุฑูุงูพุฐุฑ ูุณุชูุฏุ ูพุณ ูู ุชูุงูู ูุฑูุฏ ุจุฑฺฉโูพููุช ุฑุง ุงุฒ ุชุงุจุน <code>init</code> ุชุบุฑ ุฏูู. ู ุชูุงูู ุงู ูุดฺฉู ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ <a href=https://doc.rust-lang.org/1.30.0/book/second-edition/ch19-01-unsafe-rust.html#accessing-or-modifying-a-mutable-static-variable><code>static mut</code></a> ุญู ฺฉูู:<pre class=language-rust data-lang=rust style=background-color:#1e1e1e;color:#dcdcdc;><code class=language-rust data-lang=rust><span style=color:#569cd6;>static mut </span><span style=color:#b4cea8;>IDT</span><span>: InterruptDescriptorTable = InterruptDescriptorTable::new();
</span><span>
</span><span style=color:#569cd6;>pub fn </span><span>init_idt() {
</span><span>    </span><span style=color:#569cd6;>unsafe </span><span>{
</span><span>        </span><span style=color:#b4cea8;>IDT</span><span>.breakpoint.set_handler_fn(breakpoint_handler);
</span><span>        </span><span style=color:#b4cea8;>IDT</span><span>.load();
</span><span>    }
</span><span>}
</span></code></pre><p>ุฏุฑ ุงู ุฑูุด ุจุฏูู ุฎุทุง ฺฉุงููพุงู ู ุดูุฏ ุงูุง ูุดฺฉูุงุช ุฏฺฏุฑ ุจู ููุฑุงู ุฏุงุฑุฏ. <code>static mut</code> ุจุณุงุฑ ูุณุชุนุฏ Data Race ูุณุชูุฏุ ุจูุงุจุฑุงู ุฏุฑ ูุฑ ุฏุณุชุฑุณ ุจู ฺฉ <a href=https://doc.rust-lang.org/1.30.0/book/second-edition/ch19-01-unsafe-rust.html#unsafe-superpowers>ุจููฺฉ <code>unsafe</code></a> ูุงุฒ ุฏุงุฑู.<h4 id=lazy-statics-bh-njt-m-myaynd><a aria-label="Anchor link for: lazy-statics-bh-njt-m-myaynd" class=zola-anchor href=#lazy-statics-bh-njt-m-myaynd>๐</a>Lazy Statics ุจู ูุฌุงุช ูุง ูโุขูุฏ</h4><p>ุฎูุดุจุฎุชุงูู ูุงฺฉุฑู <code>lazy_static</code> ูุฌูุฏ ุฏุงุฑุฏ. ูุงฺฉุฑู ุจู ุฌุง ุงุฑุฒุงุจ ฺฉ <code>static</code> ุฏุฑ ุฒูุงู ฺฉุงููพุงู ุ ููุฏุงุฑุฏู ุงููู ุขู ุฑุง ููฺฏุงู ุงููู ุงุฑุฌุงุน ุจู ุขู ุงูุฌุงู ู ุฏูุฏ. ุจูุงุจุฑุงูุ ู ุชูุงูู ุชูุฑุจุงู ููู ฺฉุงุฑ ุฑุง ุฏุฑ ุจููฺฉ ููุฏุงุฑุฏู ุงููู ุงูุฌุงู ุฏูู ู ุญุช ูุงุฏุฑ ุจู ุฎูุงูุฏู ููุงุฏุฑ ุฒูุงู ุงุฌุฑุง ูุณุชู.<p>ูุง ูุจูุงู ฺฉุฑุช <code>lazy_static</code> ุฑุง ูุงุฑุฏ ฺฉุฑุฏู ููุช <a href=https://os.phil-opp.com/vga-text-mode/#lazy-statics>ฺฉ ุงูุชุฒุงุน ุจุฑุง ุจุงูุฑ ูุชู VGA ุงุฌุงุฏ ฺฉุฑุฏู</a>. ุจูุงุจุฑุงู ู ุชูุงูู ูุณุชููุงู ุงุฒ ูุงฺฉุฑู <code>!lazy_static</code> ุจุฑุง ุงุฌุงุฏ IDT ุงุณุชุงุชฺฉ ุงุณุชูุงุฏู ฺฉูู:<pre class=language-rust data-lang=rust style=background-color:#1e1e1e;color:#dcdcdc;><code class=language-rust data-lang=rust><span style=color:#608b4e;>// in src/interrupts.rs
</span><span>
</span><span style=color:#569cd6;>use </span><span>lazy_static::lazy_static;
</span><span>
</span><span>lazy_static! {
</span><span>    </span><span style=color:#569cd6;>static ref </span><span style=color:#b4cea8;>IDT</span><span>: InterruptDescriptorTable = {
</span><span>        </span><span style=color:#569cd6;>let mut</span><span> idt = InterruptDescriptorTable::new();
</span><span>        idt.breakpoint.set_handler_fn(breakpoint_handler);
</span><span>        idt
</span><span>    };
</span><span>}
</span><span>
</span><span style=color:#569cd6;>pub fn </span><span>init_idt() {
</span><span>    </span><span style=color:#b4cea8;>IDT</span><span>.load();
</span><span>}
</span></code></pre><p>ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ฺฺฏููู ุงู ุฑุงู ุญู ุจู ูฺ ุจููฺฉ <code>unsafe</code> ูุงุฒ ูุฏุงุฑุฏ. ูุงฺฉุฑู <code>!lazy_static</code> ุงุฒ <code>unsafe</code> ุฏุฑ ูพุดุช ุตุญูู ุงุณุชูุงุฏู ู ฺฉูุฏ ุ ุงูุง ุฏุฑ ฺฉ ุฑุงุจุท ุงูู ุจู ูุง ุฏุงุฏู ู ุดูุฏ.<h3 id=jry-an><a aria-label="Anchor link for: jry-an" class=zola-anchor href=#jry-an>๐</a>ุงุฌุฑุง ุขู</h3><p>ุขุฎุฑู ูุฑุญูู ุจุฑุง ฺฉุงุฑฺฉุฑุฏ ุงุณุชุซูุงูุง ุฏุฑ ูุณุชู ูุง ูุฑุงุฎูุงู ุชุงุจุน <code>init_idt</code> ุงุฒ <code>main.rs</code> ุงุณุช. ุจู ุฌุง ูุฑุงุฎูุงู ูุณุชูู ุขูุ ฺฉ ุชุงุจุน ุนููู <code>init</code> ุฑุง ุฏุฑ <code>lib.rs</code> ูุนุฑู ู ฺฉูู:<pre class=language-rust data-lang=rust style=background-color:#1e1e1e;color:#dcdcdc;><code class=language-rust data-lang=rust><span style=color:#608b4e;>// in src/lib.rs
</span><span>
</span><span style=color:#569cd6;>pub fn </span><span>init() {
</span><span>    interrupts::init_idt();
</span><span>}
</span></code></pre><p>ุจุง ุงุณุชูุงุฏู ุงุฒ ุงู ุชุงุจุน ุงฺฉููู ฺฉ ูฺฉุงู ุงุตู ุจุฑุง ุฑูุงููุง ุงููู ุฏุงุฑู ฺฉู ู ุชูุงูุฏ ุจู ุชูุงุจุน ูุฎุชูู <code>start_</code> ุฏุฑ <code>main.rs</code> ุ <code>lib.rs</code> ู ุชุณุชโูุง ฺฉโูพุงุฑฺู ุจู ุงุดุชุฑุงฺฉ ฺฏุฐุงุดุชู ุดูุฏ.<p>ุงฺฉููู ู ุชูุงูู ุชุงุจุน <code>start_</code> ุฏุฑ <code>main.rs</code> ุฑุง ุจู ุฑูุฒ ฺฉูู ุชุง <code>init</code> ุฑุง ูุฑุงุฎูุงู ฺฉุฑุฏู ู ุณูพุณ ฺฉ ุงุณุชุซูุง ุจุฑฺฉโูพููุช ุงุฌุงุฏ ฺฉูุฏ:<pre class=language-rust data-lang=rust style=background-color:#1e1e1e;color:#dcdcdc;><code class=language-rust data-lang=rust><span style=color:#608b4e;>// in src/main.rs
</span><span>
</span><span>#[no_mangle]
</span><span style=color:#569cd6;>pub extern </span><span style=color:#d69d85;>"C" </span><span style=color:#569cd6;>fn </span><span>_start() -> </span><span style=color:#569cd6;>! </span><span>{
</span><span>    println!(</span><span style=color:#d69d85;>"Hello World</span><span style=color:#b4cea8;>{}</span><span style=color:#d69d85;>"</span><span>, </span><span style=color:#d69d85;>"!"</span><span>);
</span><span>
</span><span>    blog_os::init(); </span><span style=color:#608b4e;>// new
</span><span>
</span><span>    </span><span style=color:#608b4e;>// invoke a breakpoint exception
</span><span>    x86_64::instructions::interrupts::int3(); </span><span style=color:#608b4e;>// new
</span><span>
</span><span>    </span><span style=color:#608b4e;>// as before
</span><span>    #[cfg(test)]
</span><span>    test_main();
</span><span>
</span><span>    println!(</span><span style=color:#d69d85;>"It did not crash!"</span><span>);
</span><span>    </span><span style=color:#569cd6;>loop </span><span>{}
</span><span>}
</span></code></pre><p>ุงฺฉููู ููฺฏุงู ฺฉู ุขู ุฑุง ุฏุฑ QEMU ุงุฌุฑุง ู ฺฉูู (ุจุง ุงุณุชูุงุฏู ุงุฒ <code>cargo run</code>) ุ ููุงุฑุฏ ุฒุฑ ุฑุง ูุดุงูุฏู ู ฺฉูู:<p><img alt="QEMU printing EXCEPTION: BREAKPOINT and the interrupt stack frame" src=qemu-breakpoint-exception.png><p>ฺฉุงุฑ ู ฺฉูุฏ! ูพุฑุฏุงุฒูุฏู ุจุง ููููุช ุชุงุจุน ฺฉูุชุฑู ฺฉููุฏู ุจุฑฺฉโูพููุช ูุง ุฑุง ูุฑุงุฎูุงู ู ฺฉูุฏ ุ ฺฉู ูพุงู ุฑุง ฺุงูพ ู ฺฉูุฏ ู ุณูพุณ ุจู ุชุงุจุน <code>start_</code> ุจุฑู ฺฏุฑุฏุฏ ุ ุฌุง ฺฉู ูพุงู <code>!It did not crash</code> ฺุงูพ ุดุฏู ุงุณุช.<p>ู ุจูู ฺฉู ูุงุจ ูพุดุชู ููููุ ุฏุณุชูุฑุงูุนูู ู ูุดุงูฺฏุฑูุง ูพุดุชู ุฑุง ุฏุฑ ุฒูุงู ูููุน ุงุณุชุซูุง ุจู ูุง ู ฺฏูุฏ. ุงู ุงุทูุงุนุงุช ููฺฏุงู ุฑูุน ุงุดฺฉุงู ุงุณุชุซูุงูุง ุบุฑ ููุชุธุฑู ุจุณุงุฑ ููุฏ ุงุณุช.<h3 id=fzwdn-ykh-tst><a aria-label="Anchor link for: fzwdn-ykh-tst" class=zola-anchor href=#fzwdn-ykh-tst>๐</a>ุงูุฒูุฏู ฺฉ ุชุณุช</h3><p>ุจุงุฏ ฺฉ ุชุณุช ุงุฌุงุฏ ฺฉูู ฺฉู ุงุฒ ุงุฏุงูู ฺฉุงุฑ ฺฉุฏ ุจุงูุง ุงุทููุงู ุญุงุตู ฺฉูุฏ. ุงุจุชุฏุง ุชุงุจุน <code>start_</code> ุฑุง ุจู ุฑูุฒ ู ฺฉูู ุชุง <code>init</code> ุฑุง ูุฒ ูุฑุงุฎูุงู ฺฉูุฏ:<pre class=language-rust data-lang=rust style=background-color:#1e1e1e;color:#dcdcdc;><code class=language-rust data-lang=rust><span style=color:#608b4e;>// in src/lib.rs
</span><span>
</span><span style=color:#608b4e;>/// Entry point for `cargo test`
</span><span>#[cfg(test)]
</span><span>#[no_mangle]
</span><span style=color:#569cd6;>pub extern </span><span style=color:#d69d85;>"C" </span><span style=color:#569cd6;>fn </span><span>_start() -> </span><span style=color:#569cd6;>! </span><span>{
</span><span>    init();      </span><span style=color:#608b4e;>// new
</span><span>    test_main();
</span><span>    </span><span style=color:#569cd6;>loop </span><span>{}
</span><span>}
</span></code></pre><p>ุจุฎุงุทุฑ ุฏุงุดุชู ุจุงุดุฏุ ุงู ุชุงุจุน <code>start_</code> ููฺฏุงู ุงุฌุฑุง<code>cargo test --lib</code> ุงุณุชูุงุฏู ู ุดูุฏุ ุฒุฑุง ุฑุงุณุช <code>lib.rs</code> ุฑุง ฺฉุงููุงู ูุณุชูู ุงุฒ<code>main.rs</code> ุชุณุช ูโฺฉูุฏ. ูุจู ุงุฒ ุงุฌุฑุง ุชุณุชโูุง ุจุงุฏ ุจุฑุง ุฑุงู ุงูุฏุงุฒ IDT ุฏุฑ ุงูุฌุง <code>init</code> ูุฑุงุฎูุงู ุดูุฏ.<p>ุงฺฉููู ู ุชูุงูู ฺฉ ุชุณุช <code>test_breakpoint_exception</code> ุงุฌุงุฏ ฺฉูู:<pre class=language-rust data-lang=rust style=background-color:#1e1e1e;color:#dcdcdc;><code class=language-rust data-lang=rust><span style=color:#608b4e;>// in src/interrupts.rs
</span><span>
</span><span>#[test_case]
</span><span style=color:#569cd6;>fn </span><span>test_breakpoint_exception() {
</span><span>    </span><span style=color:#608b4e;>// invoke a breakpoint exception
</span><span>    x86_64::instructions::interrupts::int3();
</span><span>}
</span></code></pre><p>ุงู ุชุณุช ุชุงุจุน <code>int3</code> ุฑุง ูุฑุงุฎูุงู ู ฺฉูุฏ ุชุง ฺฉ ุงุณุชุซูุง ุจุฑฺฉโูพููุช ุงุฌุงุฏ ฺฉูุฏ. ุจุง ุจุฑุฑุณ ุงูฺฉู ุงุฌุฑุง ูพุณ ุงุฒ ุขู ุงุฏุงูู ุฏุงุฑุฏ ุ ุชุฃุฏ ู ฺฉูู ฺฉู ฺฉูุชุฑู ฺฉููุฏู ุจุฑฺฉโูพููุช ูุง ุจู ุฏุฑุณุช ฺฉุงุฑ ู ฺฉูุฏ.<p>ุดูุง ู ุชูุงูุฏ ุงู ุชุณุช ุฌุฏุฏ ุฑุง ุจุง ุงุฌุฑุง <code>cargo test</code> (ููู ุชุณุชโูุง) ุง<code> cargo test --lib</code> (ููุท ุชุณุช ูุง <code>lib.rs</code> ู ูุงฺูู ูุง ุขู) ุงูุชุญุงู ฺฉูุฏ. ุจุงุฏ ููุงุฑุฏ ุฒุฑ ุฑุง ุฏุฑ ุฎุฑูุฌ ูุดุงูุฏู ฺฉูุฏ:<pre style=background-color:#1e1e1e;color:#dcdcdc;><code><span>blog_os::interrupts::test_breakpoint_exception...	[ok]
</span></code></pre><h2 id=khyly-jdwyy-bwd><a aria-label="Anchor link for: khyly-jdwyy-bwd" class=zola-anchor href=#khyly-jdwyy-bwd>๐</a>ุฎู ุฌุงุฏู ุจูุฏุ</h2><p>ูุฑุงุฑุฏุงุฏ ูุฑุงุฎูุงู <code>x86-interrupt</code> ู ููุน <a href=https://docs.rs/x86_64/0.14.2/x86_64/structures/idt/struct.InterruptDescriptorTable.html><code>InterruptDescriptorTable</code></a> ุฑููุฏ ูุฏุฑุช ุงุณุชุซูุงูุง ุฑุง ูุณุจุชุงู ุณุฑ ุฑุงุณุช ู ุจุฏูู ุฏุฑุฏ ุณุงุฎุชูโุงูุฏ. ุงฺฏุฑ ุงู ุจุฑุง ุดูุง ุจุณุงุฑ ุฌุงุฏู ุจูุฏ ู ุฏูุณุช ุฏุงุฑุฏ ุชูุงู ุฌุฒุฆุงุช ููู ูุฏุฑุช ุงุณุชุซูุง ุฑุง ุจุงููุฒุฏุ ุจุฑุง ุดูุง ูู ูุทุงูุจ ุฏุงุฑู: ูุฌููุนู <a href=https://os.phil-opp.com/edition-1/extra/naked-exceptions/>โูุฏุฑุช ุงุณุชุซูุงูุง ุจุง ุชูุงุจุน ุจุฑูููโ</a> ูุงุ ูุญูู ูุฏุฑุช ุงุณุชุซูุงโูุง ุจุฏูู ูุฑุงุฑุฏุงุฏ ูุฑุงุฎูุงู<code>x86-interrupt</code> ุฑุง ูุดุงู ู ุฏูุฏ ู ููฺูู ููุน IDT ุฎุงุต ุฎูุฏ ุฑุง ุงุฌุงุฏ ู ฺฉูุฏ. ุงุฒ ูุธุฑ ุชุงุฑุฎุ ุงู ูพุณุชโูุง ูููุชุฑู ูพุณุชโูุง ูุฏุฑุช ุงุณุชุซูุงูุง ูุจู ุงุฒ ูุฌูุฏ ูุฑุงุฑุฏุงุฏ ูุฑุงุฎูุงู <code>x86-interrupt</code> ู ฺฉุฑุช <code>x86_64</code> ุจูุฏูุฏ. ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุงู ูพุณุชโูุง ุจุฑ ุงุณุงุณ <a href=https://os.phil-opp.com/edition-1/>ูุณุฎู ุงูู</a> ุงู ูุจูุงฺฏ ูุณุชูุฏ ู ููฺฉู ุงุณุช ูุฏู ุจุงุดูุฏ.<h2 id=mrhlh-b-dy-chyst><a aria-label="Anchor link for: mrhlh-b-dy-chyst" class=zola-anchor href=#mrhlh-b-dy-chyst>๐</a>ูุฑุญูู ุจุนุฏ ฺุณุชุ</h2><p>ูุง ุงููู ุงุณุชุซูุง ุฎูุฏ ุฑุง ุจุง ููููุช ฺฏุฑูุชู ู ุงุฒ ุขู ุจุงุฒฺฏุดุชู! ฺฏุงู ุจุนุฏ ุงุทููุงู ุงุฒ ุงู ุงุณุช ฺฉู ููู ุงุณุชุซูุงูุง ุฑุง ู ฺฏุฑู ุ ุฒุฑุง ฺฉ ุงุณุชุซูุง ฺฏุฑูุชู ูุดุฏู ุจุงุนุซ <a href=https://wiki.osdev.org/Triple_Fault>ุฎุทุง ุณูโฺฏุงูู</a> ู ุดูุฏ ฺฉู ููุฌุฑ ุจู ุดุฑูุน ูุฌุฏุฏ ุณุณุชู ู ุดูุฏ. ูพุณุช ุจุนุฏ ุชูุถุญ ู ุฏูุฏ ฺฉู ฺฺฏููู ู ุชูุงู ุจุง ฺฏุฑูุชู ุตุญุญ <a href=https://wiki.osdev.org/Double_Fault#Double_Fault>ุฎุทุง ุฏูฺฏุงูู</a> ุงุฒ ุงู ุงูุฑ ุฌููฺฏุฑ ฺฉุฑุฏ.</div><div class="post-footer-support right-to-left"><h2>Support Me</h2><p>Creating and <a href=https://os.phil-opp.com/status-update/>maintaining</a> this blog and the associated libraries is a lot of work, but I really enjoy doing it. By supporting me, you allow me to invest more time in new content, new features, and continuous maintenance.<p>The best way to support me is to <a href=https://github.com/sponsors/phil-opp><em>sponsor me on GitHub</em></a>, since they don't charge any fees. If you prefer other platforms, I also have <a href=https://www.patreon.com/phil_opp><em>Patreon</em></a> and <a href=https://donorbox.org/phil-opp><em>Donorbox</em></a> accounts. The latter is the most flexible as it supports multiple currencies and one-time contributions.<p>Thank you!</div><hr><div class=PageNavigation><a class=prev href=/fa/testing/>ยซ ุชุณุช ฺฉุฑุฏู</a><a class=next href=/fa/double-fault-exceptions/>ุฎุทุงูุง ุฏูฺฏุงูู ยป</a></div><hr><section><h2 class=right-to-left id=comments>ูุธุฑุงุช</h2><p class=comment-note>Do you have a problem, want to share feedback, or discuss further ideas? Feel free to leave a comment here! Please stick to English and follow Rust's <a href=https://www.rust-lang.org/policies/code-of-conduct>code of conduct</a>. This comment thread directly maps to a <a href='https://github.com/phil-opp/blog_os/discussions/categories/post-comments?discussions_q="CPU Exceptions (fa)"'><em>discussion on GitHub</em></a>, so you can also comment there if you prefer.<div class=giscus></div><script data-category="Post Comments" data-repo-id="MDEwOlJlcG9zaXRvcnkzOTU3NTEwMQ==" data-term="CPU Exceptions (fa)" async crossorigin=anonymous data-category-id=MDE4OkRpc2N1c3Npb25DYXRlZ29yeTMzMDE4OTg1 data-emit-metadata=1 data-mapping=specific data-reactions-enabled=1 data-repo=phil-opp/blog_os data-theme=preferred_color_scheme src=https://giscus.app/client.js></script><p class=comment-directly-on-github>Instead of authenticating the <a href=https://giscus.app>giscus</a> application, you can also comment directly <a href='https://github.com/phil-opp/blog_os/discussions/categories/post-comments?discussions_q="CPU Exceptions (fa)"'><em>on GitHub</em></a>.<p class=right-to-left>ูุทูุง ูุธุฑุงุช ุฎูุฏ ุฑุง ุฏุฑ ุตูุฑุช ุงูฺฉุงู ุจู ุงูฺฏูุณ ุจููุณุฏ.</section><aside class=page-aside-right><div class=block id=language-selector><h2>Other Languages</h2><ul><li data-lang-switch-to=en><a href=https://os.phil-opp.com/cpu-exceptions/> English (original) </a><li data-lang-switch-to=ja><a href=https://os.phil-opp.com/ja/cpu-exceptions/> Japanese </a></ul></div><div class="dark-mode-note warning"><h2>Dark Mode is Experimental</h2><p>We're still working on adjusting text colors, fixing images, and removing inconsistencies. If you have any problems, please <a href=https://github.com/phil-opp/blog_os/issues>file an issue</a>.<aside></aside><main><div><div></div><footer class=footer><hr><small> ยฉ <time datetime=2021>2021</time>. All rights reserved. <a href=https://os.phil-opp.com/contact/>Contact</a> </small></footer></div><script async data-goatcounter=https://phil-opp.goatcounter.com/count src=//gc.zgo.at/count.js></script>